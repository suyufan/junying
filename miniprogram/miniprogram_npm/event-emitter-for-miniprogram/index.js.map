{"version":3,"sources":["event-emitter.js"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":["/* eslint-disable */\n/**\n * Modified from https://www.npmjs.com/package/event-emitter, adapted for wechat miniprogram\n */\nvar defineProperty = Object.defineProperty;\nvar create = Object.create;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar descriptor = { configurable: true, enumerable: false, writable: true };\nvar namespace = '__ee__';\n\nfunction callable(fn) {\n  if (typeof fn !== 'function') throw new TypeError(fn + ' is not a function');\n  return fn;\n}\n\nfunction arrayClone(arr) {\n  var len = arr.length;\n\tvar copy = new Array(len);\n  for (var i = 0; i < len; ++i) {\n\t\tcopy[i] = arr[i];\n\t}\n  return copy;\n}\n\nfunction EventEmitter() {}\n\nEventEmitter.prototype.on = function (type, listener) {\n  var data;\n\n  callable(listener);\n\n  if (!hasOwnProperty.call(this, namespace)) {\n    data = descriptor.value = create(null);\n    defineProperty(this, namespace, descriptor);\n    descriptor.value = null;\n  } else {\n    data = this[namespace];\n  }\n  if (!data[type]) data[type] = [listener];\n  else data[type].push(listener);\n\n  return this;\n}\n\nEventEmitter.prototype.once = function (type, listener) {\n  var self = this;\n\n  callable(listener);\n\n  var once = function once() {\n    self.off(type, once);\n    listener.apply(self, arguments);\n  };\n  once.__eeOnceListener__ = listener;\n\n  this.on(type, once);\n  return this;\n}\n\nEventEmitter.prototype.off = function (type, listener) {\n  if (!hasOwnProperty.call(this, namespace)) return this;\n\n  var data = this[namespace];\n\n  if (!data[type]) return this;\n\n  if (!listener) {\n    data[type].length = 0;\n  } else {\n    var listeners = data[type] || [];\n\n    for (var i = 0; i < listeners.length; i++) {\n      if (listeners[i] === listener || listeners[i].__eeOnceListener__ === listener) {\n        listeners.splice(i, 1);\n        break;\n      }\n    }\n  }\n\n  return this;\n}\n\nEventEmitter.prototype.emit = function () {\n  var args = Array.prototype.slice.call(arguments);\n  var type = args.splice(0, 1);\n\n  if (!hasOwnProperty.call(this, namespace)) return;\n  var listeners = this[namespace][type];\n  if (!listeners || !listeners.length) return;\n\n  listeners = arrayClone(listeners);\n  var self = this;\n\n  return Promise.all(listeners.map(function (listener) {\n    return listener.apply(self, args);\n  }));\n}\n\nmodule.exports = EventEmitter;\n"]}