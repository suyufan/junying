module.exports = (function() {
var __MODS__ = {};
var __DEFINE__ = function(modId, func, req) { var m = { exports: {}, _tempexports: {} }; __MODS__[modId] = { status: 0, func: func, req: req, m: m }; };
var __REQUIRE__ = function(modId, source) { if(!__MODS__[modId]) return require(source); if(!__MODS__[modId].status) { var m = __MODS__[modId].m; m._exports = m._tempexports; var desp = Object.getOwnPropertyDescriptor(m, "exports"); if (desp && desp.configurable) Object.defineProperty(m, "exports", { set: function (val) { if(typeof val === "object" && val !== m._exports) { m._exports.__proto__ = val.__proto__; Object.keys(val).forEach(function (k) { m._exports[k] = val[k]; }); } m._tempexports = val }, get: function () { return m._tempexports; } }); __MODS__[modId].status = 1; __MODS__[modId].func(__MODS__[modId].req, m, m.exports); } return __MODS__[modId].m.exports; };
var __REQUIRE_WILDCARD__ = function(obj) { if(obj && obj.__esModule) { return obj; } else { var newObj = {}; if(obj != null) { for(var k in obj) { if (Object.prototype.hasOwnProperty.call(obj, k)) newObj[k] = obj[k]; } } newObj.default = obj; return newObj; } };
var __REQUIRE_DEFAULT__ = function(obj) { return obj && obj.__esModule ? obj.default : obj; };
__DEFINE__(1666529690736, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=require("tslib");exports.constants=tslib_1.__importStar(require("./constants")),exports.utils=tslib_1.__importStar(require("./utils")),tslib_1.__exportStar(require("./WifiConfProtocolBase"),exports);
//# sourceMappingURL=index.js.map
}, function(modId) {var map = {"./constants":1666529690737,"./utils":1666529690743,"./WifiConfProtocolBase":1666529690766}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690737, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=require("tslib");tslib_1.__exportStar(require("./default-guides"),exports),tslib_1.__exportStar(require("./errors"),exports),tslib_1.__exportStar(require("./steps"),exports),tslib_1.__exportStar(require("./stat"),exports),tslib_1.__exportStar(require("./step-desp"),exports);
//# sourceMappingURL=index.js.map
}, function(modId) { var map = {"./default-guides":1666529690738,"./errors":1666529690739,"./steps":1666529690740,"./stat":1666529690741,"./step-desp":1666529690742}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690738, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0}),exports.PullWifiListErrorMsg=exports.InputDeviceWifiInfoFormGuide=exports.InputDeviceWifiInfoIntroGuide=exports.WifiSmartConfigHardwareGuide=void 0;var tslib_1=require("tslib"),errors_1=require("./errors");exports.WifiSmartConfigHardwareGuide="1. 接通设备电源。\n2. 长按复位键（开关）5 秒，指示灯快闪时，再次长按复位键 3 秒。\n3. 指示灯进入慢闪状态即可。",exports.InputDeviceWifiInfoIntroGuide="1. 接下来您需要将手机WiFi连接到设备热点，设备热点名称如上图所示。",exports.InputDeviceWifiInfoFormGuide="1. 点击WiFi名称右侧的下拉按钮，选择设备热点。\n2. 填写设备热点密码，若设备热点无密码则无需填写。\n3. 点击下一步，开始配网。",exports.PullWifiListErrorMsg=tslib_1.__assign(tslib_1.__assign({},errors_1.WifiConfErrorMsg),{IOS_REFRESH_TIMEOUT:"获取WiFi列表超时，请重试",DEFAULT:"请检查WiFi开关是否打开后重试"});
//# sourceMappingURL=default-guides.js.map
}, function(modId) { var map = {"./errors":1666529690739}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690739, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConnectLogWifiError=exports.WifiConnectErrorMsg=exports.WifiConfErrorMsg=void 0;var isIOS=navigator?navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/):"ios"===wx.getSystemInfoSync().platform;exports.WifiConfErrorMsg={UDP_ERROR:"发送配网消息失败，请重启微信APP后重试配网",UDP_CLOSED:"设备连接中断，请检查设备配网状态后重试",UDP_SEND_MSG_FAIL:"设备连接失败，请检查设备配网状态后重试",UDP_NOT_RESPONSE:"设备未响应，请检查设备和网络后重试",CONNECT_WIFI_FAIL:"CONNECT_WIFI_FAIL",CONNECT_WIFI_IN_SETTING_ERROR:"在设置页连接失败",CONNECT_WIFI_IN_SETTING_TIMEOUT:"在设置页连接超时",WIFI_CONF_FAIL:"配网失败，请检查设备和网络后重试",PROTOCOL_FAIL:"配网失败，请检查设备和网络后重试",PROTOCOL_TIMEOUT:"配网超时，请检查设备和网络后重试",PROTOCOL_INVALID_RESPONSE:"无效响应，请检查设备和网络后重试",BUSINESS_DEVICE_ERROR:"设备连接中断，请检查设备配网状态后重试",BUSINESS_INVALID_RESPONSE:"设备响应错误，请检查设备和网络后重试",BUSINESS_DEVICE_CONNECT_MQTT_FAIL:"设备连接云端失败，请检查网络后重试",BUSINESS_DEVICE_CONNECT_WIFI_FAIL:"设备连接网络失败，请检查WiFi密码后重试",BUSINESS_ADD_DEVICE_FAIL:"添加设备失败",BUSINESS_QUERY_BIND_TOKEN_TIMEOUT:"设备连接云端超时，请检查WiFi密码后重试",BUSINESS_QUERY_BIND_TOKEN_FAIL:"查询设备连接云端状态失败，请检查网络后重试",BUSINESS_WIFI_RECONNECT_FAIL:"小程序重新连接目标WI-FI失败，重试时请弹窗提示失败后手动切换再按确定",MODULE_REPORT_CONNECT_WIFI_ERROR:"连接设备失败，请检查设备电源和信号后重试",MODULE_REPORT_COMMUNICATE_AP_ERROR:"与设备通信失败，请检查设备电源和信号后重试",MODULE_REPORT_ERROR:"收集设备日志失败，请检查设备电源和信号后重试",MODULE_REPORT_TIMEOUT:"收集设备日志超时，请检查设备电源和信号后重试"},exports.WifiConnectErrorMsg={12e3:"WiFi模块初始化失败，请重启微信后重试",12001:"您的设备或系统不支持进行WiFi连接",12002:"请检查您的WiFi密码是否正确",12003:"连接WiFi热点超时，请重新连接",12004:"重复连接 Wi-Fi",12005:"配网操作需打开WiFi开关，请打开后重试",12006:"配网操作需打开GPS定位开关，请打开后重试",12007:isIOS?"WiFi连接操作被拒绝，请重试并在弹出的提示框中点击“加入”":"WiFi连接操作被拒绝，请重试并在弹出的提示框中点击允许连接WiFi",12008:"请确认连接的WiFi热点是否正确",12009:"配置WiFi连接失败，请尝试其他WiFi热点",12011:"配置WiFi连接失败，请重试",12013:"系统保存的WiFi配置过期，请在系统设置中忘记该WiFi后重试",NO_WIFI_IS_CONNECTED:"请检查WiFi信号和密码后重试",SSID_MISMATCH:"请检查WiFi信号和密码后重试",SOFTAP_WIFIINFO_MISMATCH:"当前连接Wi-Fi与设备热点名称不匹配",IOS_REFRESH_TIMEOUT:"获取WiFi列表超时，请重试",DEFAULT:"请检查WiFi开关是否打开后重试"},exports.ConnectLogWifiError=Object.assign({12002:"连接设备失败",12003:"连接设备超时，请检查设备电源和信号后重试",12005:"收集设备日志需打开WiFi开关，请打开后重试",12006:"收集设备日志需打开GPS定位开关，请打开后重试",12009:"连接设备失败",12011:"连接设备失败，请重试",NO_WIFI_IS_CONNECTED:"连接设备失败，请检查设备电源和信号后重试",RECONNECT_WIFI_FAIL:"连接设备失败，请检查设备电源和信号后重试",DEFAULT:"连接设备失败，请检查设备电源和信号后重试"},exports.WifiConnectErrorMsg);
//# sourceMappingURL=errors.js.map
}, function(modId) { var map = {}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690740, function(require, module, exports) {
var WifiConfStepCode;Object.defineProperty(exports,"__esModule",{value:!0}),exports.WifiConfStepCode=void 0,function(_){_.WIFI_CONF_START="WIFI_CONF_START",_.WIFI_CONF_RESTART="WIFI_CONF_RESTART",_.WIFI_CONF_SUCCESS="WIFI_CONF_SUCCESS",_.WIFI_CONF_FAIL="WIFI_CONF_FAIL",_.WIFI_CONF_AUTO_RETRY="WIFI_CONF_AUTO_RETRY",_.PROTOCOL_START="PROTOCOL_START",_.PROTOCOL_SUCCESS="PROTOCOL_SUCCESS",_.PROTOCOL_DETAIL="PROTOCOL_DETAIL",_.CREATE_UDP_CONNECTION_START="CREATE_UDP_CONNECTION_START",_.CREATE_UDP_CONNECTION_SUCCESS="CREATE_UDP_CONNECTION_SUCCESS",_.BUSINESS_START="BUSINESS_START",_.BUSINESS_QUERY_TOKEN_STATE_START="BUSINESS_QUERY_TOKEN_STATE_START",_.BUSINESS_QUERY_TOKEN_STATE_SUCCESS="BUSINESS_QUERY_TOKEN_STATE_SUCCESS",_.BUSINESS_ADD_DEVICE_START="BUSINESS_ADD_DEVICE_START",_.BUSINESS_ADD_DEVICE_SUCCESS="BUSINESS_ADD_DEVICE_SUCCESS",_.BUSINESS_SUCCESS="BUSINESS_SUCCESS",_.CONNECT_WIFI_START="CONNECT_WIFI_START",_.CONNECT_WIFI_SUCCESS="CONNECT_WIFI_SUCCESS",_.CONNECT_WIFI_MANUAL="CONNECT_WIFI_MANUAL",_.SOFTAP_GET_DEVICE_SIGNATURE_START="SOFTAP_GET_DEVICE_SIGNATURE_START",_.SOFTAP_GET_DEVICE_SIGNATURE_SUCCESS="SOFTAP_GET_DEVICE_SIGNATURE_SUCCESS",_.SOFTAP_SEND_TARGET_WIFIINFO_START="SOFTAP_SEND_TARGET_WIFIINFO_START",_.SOFTAP_SEND_TARGET_WIFIINFO_SUCCESS="SOFTAP_SEND_TARGET_WIFIINFO_SUCCESS",_.SOFTAP_RECONNECT_TARGET_WIFI_START="SOFTAP_RECONNECT_TARGET_WIFI_START",_.SOFTAP_RECONNECT_TARGET_WIFI_SUCCESS="SOFTAP_RECONNECT_TARGET_WIFI_SUCCESS",_.AUTO_HANDLE_WIFI_PROBLEM_START="AUTO_HANDLE_WIFI_PROBLEM_START",_.AUTO_HANDLE_WIFI_PROBLEM_CANCEL="AUTO_HANDLE_WIFI_PROBLEM_CANCEL",_.AUTO_HANDLE_WIFI_PROBLEM_SUCCESS="AUTO_HANDLE_WIFI_PROBLEM_SUCCESS",_.AUTO_HANDLE_WIFI_NO_ROUTE="AUTO_HANDLE_WIFI_NO_ROUTE",_.MODULE_REPORT_START="MODULE_REPORT_START",_.MODULE_REPORT_CONNECT_WIFI_START="MODULE_REPORT_CONNECT_WIFI_START",_.MODULE_REPORT_CONNECT_WIFI_SUCCESS="MODULE_REPORT_CONNECT_WIFI_SUCCESS",_.MODULE_REPORT_COMMUNICATE_AP_START="MODULE_REPORT_COMMUNICATE_AP_START",_.MODULE_REPORT_COMMUNICATE_AP_SUCCESS="MODULE_REPORT_COMMUNICATE_AP_SUCCESS",_.MODULE_REPORT_COMMUNICATE_END="MODULE_REPORT_COMMUNICATE_END"}(WifiConfStepCode=exports.WifiConfStepCode||(exports.WifiConfStepCode={}));
//# sourceMappingURL=steps.js.map
}, function(modId) { var map = {}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690741, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0}),exports.MyStatDimension=exports.MpStatType=void 0,exports.MpStatType={CGI:1001,HomeRender:2002,SoftAp:2003,SmartConfig:2004,AirKiss:2005,SimpleConfig:2006},exports.MyStatDimension={SoftAp:{ConnectWifi:"connectWifi",CostTime:"softapCostTime",SendWifiInfo:"softapSendWifiInfo"},SmartConfig:{CostTime:"smartConfigCostTime",SendToken:"smartconfigSendToken",SendWifiInfo:"smartConfigSendWifiInfo"},SimpleConfig:{CostTime:"simpleConfigCostTime",SendToken:"simpleConfigSendToken",SendWifiInfo:"simpleConfigSendWifiInfo"},AirKiss:{SendWifiInfo:"sendWifiInfo",CostTime:"costTime",SendToken:"sendToken"}};
//# sourceMappingURL=stat.js.map
}, function(modId) { var map = {}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690742, function(require, module, exports) {
var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.WifiConfStepDesp=void 0;var steps_1=require("./steps");exports.WifiConfStepDesp=((_a={})[steps_1.WifiConfStepCode.WIFI_CONF_START]="开始配网",_a[steps_1.WifiConfStepCode.WIFI_CONF_RESTART]="重新配网",_a[steps_1.WifiConfStepCode.WIFI_CONF_SUCCESS]="配网成功",_a[steps_1.WifiConfStepCode.PROTOCOL_START]="开始进行配网协议传输",_a[steps_1.WifiConfStepCode.PROTOCOL_SUCCESS]="配网协议传输成功",_a[steps_1.WifiConfStepCode.PROTOCOL_DETAIL]="配网协议传输详情",_a[steps_1.WifiConfStepCode.CREATE_UDP_CONNECTION_START]="开始与设备建立UDP连接",_a[steps_1.WifiConfStepCode.CREATE_UDP_CONNECTION_SUCCESS]="设备建立UDP连接成功",_a[steps_1.WifiConfStepCode.BUSINESS_START]="开始业务流程",_a[steps_1.WifiConfStepCode.BUSINESS_QUERY_TOKEN_STATE_START]="开始查询TOKEN状态",_a[steps_1.WifiConfStepCode.BUSINESS_QUERY_TOKEN_STATE_SUCCESS]="查询TOKEN状态成功",_a[steps_1.WifiConfStepCode.BUSINESS_SUCCESS]="业务流程执行成功",_a[steps_1.WifiConfStepCode.BUSINESS_ADD_DEVICE_START]="开始绑定设备",_a[steps_1.WifiConfStepCode.BUSINESS_ADD_DEVICE_SUCCESS]="绑定设备成功",_a[steps_1.WifiConfStepCode.CONNECT_WIFI_START]="开始连接WIFI",_a[steps_1.WifiConfStepCode.CONNECT_WIFI_SUCCESS]="连接WIFI成功",_a[steps_1.WifiConfStepCode.CONNECT_WIFI_MANUAL]="WIFI已手动连接",_a[steps_1.WifiConfStepCode.SOFTAP_GET_DEVICE_SIGNATURE_START]="SOFTAP开始获取设备签名",_a[steps_1.WifiConfStepCode.SOFTAP_GET_DEVICE_SIGNATURE_SUCCESS]="获取设备签名成功",_a[steps_1.WifiConfStepCode.SOFTAP_RECONNECT_TARGET_WIFI_START]="重连有网WIFI",_a[steps_1.WifiConfStepCode.SOFTAP_RECONNECT_TARGET_WIFI_SUCCESS]="重连有网WIFI成功",_a[steps_1.WifiConfStepCode.SOFTAP_SEND_TARGET_WIFIINFO_START]="开始发送目标 Wi-Fi 信息",_a[steps_1.WifiConfStepCode.SOFTAP_SEND_TARGET_WIFIINFO_SUCCESS]="发送目标 Wi-Fi 信息成功",_a[steps_1.WifiConfStepCode.AUTO_HANDLE_WIFI_PROBLEM_START]="自动处理故障开始",_a[steps_1.WifiConfStepCode.AUTO_HANDLE_WIFI_PROBLEM_CANCEL]="取消自动处理故障",_a[steps_1.WifiConfStepCode.AUTO_HANDLE_WIFI_PROBLEM_SUCCESS]="自动处理故障成功",_a[steps_1.WifiConfStepCode.MODULE_REPORT_START]="设备上报日志模式开始",_a[steps_1.WifiConfStepCode.MODULE_REPORT_CONNECT_WIFI_START]="设备上报日志模式开始连接设备AP",_a[steps_1.WifiConfStepCode.MODULE_REPORT_CONNECT_WIFI_SUCCESS]="设备上报日志模式连接设备AP成功",_a[steps_1.WifiConfStepCode.MODULE_REPORT_COMMUNICATE_AP_START]="开始跟设备通信",_a[steps_1.WifiConfStepCode.MODULE_REPORT_COMMUNICATE_AP_SUCCESS]="收集设备日志成功",_a[steps_1.WifiConfStepCode.MODULE_REPORT_COMMUNICATE_END]="设备上报日志模式结束",_a);
//# sourceMappingURL=step-desp.js.map
}, function(modId) { var map = {"./steps":1666529690740}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690743, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=require("tslib");tslib_1.__exportStar(require("./bytes"),exports),tslib_1.__exportStar(require("./crypto"),exports),tslib_1.__exportStar(require("./security"),exports),tslib_1.__exportStar(require("./udp"),exports),tslib_1.__exportStar(require("./moduleLog"),exports),tslib_1.__exportStar(require("./tryRequest"),exports),tslib_1.__exportStar(require("./UdpServer"),exports),tslib_1.__exportStar(require("./util"),exports),tslib_1.__exportStar(require("./reconnectWifi"),exports),tslib_1.__exportStar(require("./connectWifi"),exports),tslib_1.__exportStar(require("./getConnectedWifi"),exports),tslib_1.__exportStar(require("./pollRequest"),exports),exports.wxApis=tslib_1.__importStar(require("./wxApis"));
//# sourceMappingURL=index.js.map
}, function(modId) { var map = {"./bytes":1666529690744,"./crypto":1666529690746,"./security":1666529690750,"./udp":1666529690753,"./moduleLog":1666529690757,"./tryRequest":1666529690760,"./UdpServer":1666529690758,"./util":1666529690749,"./reconnectWifi":1666529690761,"./connectWifi":1666529690764,"./getConnectedWifi":1666529690763,"./pollRequest":1666529690765,"./wxApis":1666529690759}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690744, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=require("tslib");tslib_1.__exportStar(require("./CRC8"),exports);
//# sourceMappingURL=index.js.map
}, function(modId) { var map = {"./CRC8":1666529690745}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690745, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0}),exports.CRC8=void 0;var qcloud_iotexplorer_appdev_sdk_1=require("qcloud-iotexplorer-appdev-sdk"),byteUtil=qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.byteUtil,CRC8=function(){function t(){this.crcTable=new Int32Array(256),this.CRC_POLYNOM=140,this.CRC_INITIAL=0;for(var t=0;t<256;t++){for(var e=t,r=0;r<8;++r)0!=(1&e)?e=e>>>1^this.CRC_POLYNOM:e>>>=1;this.crcTable[t]=e}this.value=this.init=this.CRC_INITIAL}return t.prototype.updateValue=function(t,e,r){for(var i=0;i<r;i++){var o=t[e+i]^this.value;this.value=this.crcTable[255&o]^this.value<<8}},t.prototype.update=function(t){t instanceof Int8Array?this.updateValue(t,0,t.length):"number"==typeof t&&this.update(new Int8Array([byteUtil.convertNumberToByte(t)]))},t.prototype.getValue=function(){return 255&this.value},t.prototype.reset=function(){this.value=this.init},t}();exports.CRC8=CRC8;
//# sourceMappingURL=CRC8.js.map
}, function(modId) { var map = {}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690746, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=require("tslib");tslib_1.__exportStar(require("./AesCrypto"),exports),tslib_1.__exportStar(require("./BlockCipher"),exports);
//# sourceMappingURL=index.js.map
}, function(modId) { var map = {"./AesCrypto":1666529690747,"./BlockCipher":1666529690748}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690747, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0}),exports.Aes=void 0;var BlockCipher_1=require("./BlockCipher"),util_1=require("../util");exports.Aes=function(t){BlockCipher_1.BlockCipher.call(this),exports.Aes.assertKeyArray_(t),this.key_=t,this.keyLengthInWords_=this.key_.length/4,this.numberOfRounds_=this.keyLengthInWords_+6,this.state_=[[],[],[],[]],this.temp_=[[],[],[],[]],this.keySchedule_,this.keyExpansion_()},exports.Aes.prototype=Object.create(BlockCipher_1.BlockCipher.prototype),exports.Aes.prototype.construtor=BlockCipher_1.BlockCipher,exports.Aes.prototype.BLOCK_SIZE=16,exports.Aes.BLOCK_SIZE_IN_WORDS_=exports.Aes.prototype.BLOCK_SIZE/4,exports.Aes.ENABLE_TEST_MODE=!1,exports.Aes.prototype.encrypt=function(t){exports.Aes.ENABLE_TEST_MODE&&this.testKeySchedule_(0,this.keySchedule_,0),this.copyInput_(t),this.addRoundKey_(0);for(var e=1;e<this.numberOfRounds_;++e)exports.Aes.ENABLE_TEST_MODE&&(this.testKeySchedule_(e,this.keySchedule_,e),this.testStartRound_(e,this.state_)),this.subBytes_(exports.Aes.SBOX_),exports.Aes.ENABLE_TEST_MODE&&this.testAfterSubBytes_(e,this.state_),this.shiftRows_(),exports.Aes.ENABLE_TEST_MODE&&this.testAfterShiftRows_(e,this.state_),this.mixColumns_(),exports.Aes.ENABLE_TEST_MODE&&this.testAfterMixColumns_(e,this.state_),this.addRoundKey_(e);return this.subBytes_(exports.Aes.SBOX_),exports.Aes.ENABLE_TEST_MODE&&this.testAfterSubBytes_(e,this.state_),this.shiftRows_(),exports.Aes.ENABLE_TEST_MODE&&this.testAfterShiftRows_(e,this.state_),this.addRoundKey_(this.numberOfRounds_),this.generateOutput_()},exports.Aes.prototype.decrypt=function(t){exports.Aes.ENABLE_TEST_MODE&&this.testKeySchedule_(0,this.keySchedule_,this.numberOfRounds_),this.copyInput_(t),this.addRoundKey_(this.numberOfRounds_);for(var e=1;e<this.numberOfRounds_;++e)exports.Aes.ENABLE_TEST_MODE&&(this.testKeySchedule_(e,this.keySchedule_,this.numberOfRounds_-e),this.testStartRound_(e,this.state_)),this.invShiftRows_(),exports.Aes.ENABLE_TEST_MODE&&this.testAfterShiftRows_(e,this.state_),this.subBytes_(exports.Aes.INV_SBOX_),exports.Aes.ENABLE_TEST_MODE&&this.testAfterSubBytes_(e,this.state_),this.addRoundKey_(this.numberOfRounds_-e),exports.Aes.ENABLE_TEST_MODE&&this.testAfterAddRoundKey_(e,this.state_),this.invMixColumns_();return this.invShiftRows_(),exports.Aes.ENABLE_TEST_MODE&&this.testAfterShiftRows_(e,this.state_),this.subBytes_(exports.Aes.INV_SBOX_),exports.Aes.ENABLE_TEST_MODE&&this.testAfterSubBytes_(this.numberOfRounds_,this.state_),exports.Aes.ENABLE_TEST_MODE&&this.testKeySchedule_(this.numberOfRounds_,this.keySchedule_,0),this.addRoundKey_(0),this.generateOutput_()},exports.Aes.assertKeyArray_=function(t){if(16!=t.length&&24!=t.length&&32!=t.length)throw"Key must have length 16, 24, or 32.";for(var e=0;e<t.length;e++){if("number"!=typeof t[e])throw"arr[i] must be number";if(!(t[e]>=0&&t[e]<=255))throw"arr[i] must be [0, 255]"}},exports.Aes.prototype.testStartRound_=util_1.noop,exports.Aes.prototype.testAfterSubBytes_=util_1.noop,exports.Aes.prototype.testAfterShiftRows_=util_1.noop,exports.Aes.prototype.testAfterMixColumns_=util_1.noop,exports.Aes.prototype.testAfterAddRoundKey_=util_1.noop,exports.Aes.prototype.testKeySchedule_=util_1.noop,exports.Aes.prototype.copyInput_=function(t){var e,s;if(t.length!==this.BLOCK_SIZE)throw"Expecting input of block size.";for(var _=0;_<exports.Aes.BLOCK_SIZE_IN_WORDS_;_++)for(var o=0;o<4;o++){if(!((e=t[s=4*o+_])<=255&&e>=0))throw"Invalid input. Value "+e+" at position "+s+" is not a byte.";this.state_[_][o]=e}},exports.Aes.prototype.generateOutput_=function(){for(var t=[],e=0;e<exports.Aes.BLOCK_SIZE_IN_WORDS_;e++)for(var s=0;s<4;s++)t[4*s+e]=this.state_[e][s];return t},exports.Aes.prototype.addRoundKey_=function(t){for(var e=0;e<4;e++)for(var s=0;s<4;s++)this.state_[e][s]^=this.keySchedule_[4*t+s][e]},exports.Aes.prototype.subBytes_=function(t){for(var e=0;e<4;e++)for(var s=0;s<4;s++)this.state_[e][s]=t[this.state_[e][s]]},exports.Aes.prototype.shiftRows_=function(){for(var t=1;t<4;t++)for(var e=0;e<4;e++)this.temp_[t][e]=this.state_[t][e];for(t=1;t<4;t++)for(e=0;e<4;e++)this.state_[t][e]=this.temp_[t][(e+t)%exports.Aes.BLOCK_SIZE_IN_WORDS_]},exports.Aes.prototype.invShiftRows_=function(){for(var t=1;t<4;t++)for(var e=0;e<4;e++)this.temp_[t][(e+t)%exports.Aes.BLOCK_SIZE_IN_WORDS_]=this.state_[t][e];for(t=1;t<4;t++)for(e=0;e<4;e++)this.state_[t][e]=this.temp_[t][e]},exports.Aes.prototype.mixColumns_=function(){for(var t=this.state_,e=this.temp_[0],s=0;s<4;s++)e[0]=t[0][s],e[1]=t[1][s],e[2]=t[2][s],e[3]=t[3][s],t[0][s]=exports.Aes.MULT_2_[e[0]]^exports.Aes.MULT_3_[e[1]]^e[2]^e[3],t[1][s]=e[0]^exports.Aes.MULT_2_[e[1]]^exports.Aes.MULT_3_[e[2]]^e[3],t[2][s]=e[0]^e[1]^exports.Aes.MULT_2_[e[2]]^exports.Aes.MULT_3_[e[3]],t[3][s]=exports.Aes.MULT_3_[e[0]]^e[1]^e[2]^exports.Aes.MULT_2_[e[3]]},exports.Aes.prototype.invMixColumns_=function(){for(var t=this.state_,e=this.temp_[0],s=0;s<4;s++)e[0]=t[0][s],e[1]=t[1][s],e[2]=t[2][s],e[3]=t[3][s],t[0][s]=exports.Aes.MULT_E_[e[0]]^exports.Aes.MULT_B_[e[1]]^exports.Aes.MULT_D_[e[2]]^exports.Aes.MULT_9_[e[3]],t[1][s]=exports.Aes.MULT_9_[e[0]]^exports.Aes.MULT_E_[e[1]]^exports.Aes.MULT_B_[e[2]]^exports.Aes.MULT_D_[e[3]],t[2][s]=exports.Aes.MULT_D_[e[0]]^exports.Aes.MULT_9_[e[1]]^exports.Aes.MULT_E_[e[2]]^exports.Aes.MULT_B_[e[3]],t[3][s]=exports.Aes.MULT_B_[e[0]]^exports.Aes.MULT_D_[e[1]]^exports.Aes.MULT_9_[e[2]]^exports.Aes.MULT_E_[e[3]]},exports.Aes.prototype.keyExpansion_=function(){this.keySchedule_=new Array(exports.Aes.BLOCK_SIZE_IN_WORDS_*(this.numberOfRounds_+1));for(var t=0;t<this.keyLengthInWords_;t++)this.keySchedule_[t]=[this.key_[4*t],this.key_[4*t+1],this.key_[4*t+2],this.key_[4*t+3]];var e=new Array(4);for(t=this.keyLengthInWords_;t<exports.Aes.BLOCK_SIZE_IN_WORDS_*(this.numberOfRounds_+1);t++)e[0]=this.keySchedule_[t-1][0],e[1]=this.keySchedule_[t-1][1],e[2]=this.keySchedule_[t-1][2],e[3]=this.keySchedule_[t-1][3],t%this.keyLengthInWords_==0?(this.rotWord_(e),this.subWord_(e),e[0]^=exports.Aes.RCON_[t/this.keyLengthInWords_][0],e[1]^=exports.Aes.RCON_[t/this.keyLengthInWords_][1],e[2]^=exports.Aes.RCON_[t/this.keyLengthInWords_][2],e[3]^=exports.Aes.RCON_[t/this.keyLengthInWords_][3]):this.keyLengthInWords_>6&&t%this.keyLengthInWords_==4&&this.subWord_(e),this.keySchedule_[t]=new Array(4),this.keySchedule_[t][0]=this.keySchedule_[t-this.keyLengthInWords_][0]^e[0],this.keySchedule_[t][1]=this.keySchedule_[t-this.keyLengthInWords_][1]^e[1],this.keySchedule_[t][2]=this.keySchedule_[t-this.keyLengthInWords_][2]^e[2],this.keySchedule_[t][3]=this.keySchedule_[t-this.keyLengthInWords_][3]^e[3]},exports.Aes.prototype.subWord_=function(t){return t[0]=exports.Aes.SBOX_[t[0]],t[1]=exports.Aes.SBOX_[t[1]],t[2]=exports.Aes.SBOX_[t[2]],t[3]=exports.Aes.SBOX_[t[3]],t},exports.Aes.prototype.rotWord_=function(t){var e=t[0];return t[0]=t[1],t[1]=t[2],t[2]=t[3],t[3]=e,t},exports.Aes.SBOX_=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],exports.Aes.INV_SBOX_=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],exports.Aes.RCON_=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]],exports.Aes.MULT_2_=[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,118,120,122,124,126,128,130,132,134,136,138,140,142,144,146,148,150,152,154,156,158,160,162,164,166,168,170,172,174,176,178,180,182,184,186,188,190,192,194,196,198,200,202,204,206,208,210,212,214,216,218,220,222,224,226,228,230,232,234,236,238,240,242,244,246,248,250,252,254,27,25,31,29,19,17,23,21,11,9,15,13,3,1,7,5,59,57,63,61,51,49,55,53,43,41,47,45,35,33,39,37,91,89,95,93,83,81,87,85,75,73,79,77,67,65,71,69,123,121,127,125,115,113,119,117,107,105,111,109,99,97,103,101,155,153,159,157,147,145,151,149,139,137,143,141,131,129,135,133,187,185,191,189,179,177,183,181,171,169,175,173,163,161,167,165,219,217,223,221,211,209,215,213,203,201,207,205,195,193,199,197,251,249,255,253,243,241,247,245,235,233,239,237,227,225,231,229],exports.Aes.MULT_3_=[0,3,6,5,12,15,10,9,24,27,30,29,20,23,18,17,48,51,54,53,60,63,58,57,40,43,46,45,36,39,34,33,96,99,102,101,108,111,106,105,120,123,126,125,116,119,114,113,80,83,86,85,92,95,90,89,72,75,78,77,68,71,66,65,192,195,198,197,204,207,202,201,216,219,222,221,212,215,210,209,240,243,246,245,252,255,250,249,232,235,238,237,228,231,226,225,160,163,166,165,172,175,170,169,184,187,190,189,180,183,178,177,144,147,150,149,156,159,154,153,136,139,142,141,132,135,130,129,155,152,157,158,151,148,145,146,131,128,133,134,143,140,137,138,171,168,173,174,167,164,161,162,179,176,181,182,191,188,185,186,251,248,253,254,247,244,241,242,227,224,229,230,239,236,233,234,203,200,205,206,199,196,193,194,211,208,213,214,223,220,217,218,91,88,93,94,87,84,81,82,67,64,69,70,79,76,73,74,107,104,109,110,103,100,97,98,115,112,117,118,127,124,121,122,59,56,61,62,55,52,49,50,35,32,37,38,47,44,41,42,11,8,13,14,7,4,1,2,19,16,21,22,31,28,25,26],exports.Aes.MULT_9_=[0,9,18,27,36,45,54,63,72,65,90,83,108,101,126,119,144,153,130,139,180,189,166,175,216,209,202,195,252,245,238,231,59,50,41,32,31,22,13,4,115,122,97,104,87,94,69,76,171,162,185,176,143,134,157,148,227,234,241,248,199,206,213,220,118,127,100,109,82,91,64,73,62,55,44,37,26,19,8,1,230,239,244,253,194,203,208,217,174,167,188,181,138,131,152,145,77,68,95,86,105,96,123,114,5,12,23,30,33,40,51,58,221,212,207,198,249,240,235,226,149,156,135,142,177,184,163,170,236,229,254,247,200,193,218,211,164,173,182,191,128,137,146,155,124,117,110,103,88,81,74,67,52,61,38,47,16,25,2,11,215,222,197,204,243,250,225,232,159,150,141,132,187,178,169,160,71,78,85,92,99,106,113,120,15,6,29,20,43,34,57,48,154,147,136,129,190,183,172,165,210,219,192,201,246,255,228,237,10,3,24,17,46,39,60,53,66,75,80,89,102,111,116,125,161,168,179,186,133,140,151,158,233,224,251,242,205,196,223,214,49,56,35,42,21,28,7,14,121,112,107,98,93,84,79,70],exports.Aes.MULT_B_=[0,11,22,29,44,39,58,49,88,83,78,69,116,127,98,105,176,187,166,173,156,151,138,129,232,227,254,245,196,207,210,217,123,112,109,102,87,92,65,74,35,40,53,62,15,4,25,18,203,192,221,214,231,236,241,250,147,152,133,142,191,180,169,162,246,253,224,235,218,209,204,199,174,165,184,179,130,137,148,159,70,77,80,91,106,97,124,119,30,21,8,3,50,57,36,47,141,134,155,144,161,170,183,188,213,222,195,200,249,242,239,228,61,54,43,32,17,26,7,12,101,110,115,120,73,66,95,84,247,252,225,234,219,208,205,198,175,164,185,178,131,136,149,158,71,76,81,90,107,96,125,118,31,20,9,2,51,56,37,46,140,135,154,145,160,171,182,189,212,223,194,201,248,243,238,229,60,55,42,33,16,27,6,13,100,111,114,121,72,67,94,85,1,10,23,28,45,38,59,48,89,82,79,68,117,126,99,104,177,186,167,172,157,150,139,128,233,226,255,244,197,206,211,216,122,113,108,103,86,93,64,75,34,41,52,63,14,5,24,19,202,193,220,215,230,237,240,251,146,153,132,143,190,181,168,163],exports.Aes.MULT_D_=[0,13,26,23,52,57,46,35,104,101,114,127,92,81,70,75,208,221,202,199,228,233,254,243,184,181,162,175,140,129,150,155,187,182,161,172,143,130,149,152,211,222,201,196,231,234,253,240,107,102,113,124,95,82,69,72,3,14,25,20,55,58,45,32,109,96,119,122,89,84,67,78,5,8,31,18,49,60,43,38,189,176,167,170,137,132,147,158,213,216,207,194,225,236,251,246,214,219,204,193,226,239,248,245,190,179,164,169,138,135,144,157,6,11,28,17,50,63,40,37,110,99,116,121,90,87,64,77,218,215,192,205,238,227,244,249,178,191,168,165,134,139,156,145,10,7,16,29,62,51,36,41,98,111,120,117,86,91,76,65,97,108,123,118,85,88,79,66,9,4,19,30,61,48,39,42,177,188,171,166,133,136,159,146,217,212,195,206,237,224,247,250,183,186,173,160,131,142,153,148,223,210,197,200,235,230,241,252,103,106,125,112,83,94,73,68,15,2,21,24,59,54,33,44,12,1,22,27,56,53,34,47,100,105,126,115,80,93,74,71,220,209,198,203,232,229,242,255,180,185,174,163,128,141,154,151],exports.Aes.MULT_E_=[0,14,28,18,56,54,36,42,112,126,108,98,72,70,84,90,224,238,252,242,216,214,196,202,144,158,140,130,168,166,180,186,219,213,199,201,227,237,255,241,171,165,183,185,147,157,143,129,59,53,39,41,3,13,31,17,75,69,87,89,115,125,111,97,173,163,177,191,149,155,137,135,221,211,193,207,229,235,249,247,77,67,81,95,117,123,105,103,61,51,33,47,5,11,25,23,118,120,106,100,78,64,82,92,6,8,26,20,62,48,34,44,150,152,138,132,174,160,178,188,230,232,250,244,222,208,194,204,65,79,93,83,121,119,101,107,49,63,45,35,9,7,21,27,161,175,189,179,153,151,133,139,209,223,205,195,233,231,245,251,154,148,134,136,162,172,190,176,234,228,246,248,210,220,206,192,122,116,102,104,66,76,94,80,10,4,22,24,50,60,46,32,236,226,240,254,212,218,200,198,156,146,128,142,164,170,184,182,12,2,16,30,52,58,40,38,124,114,96,110,68,74,88,86,55,57,43,37,15,1,19,29,71,73,91,85,127,113,99,109,215,217,203,197,239,225,243,253,167,169,187,181,159,145,131,141];
//# sourceMappingURL=AesCrypto.js.map
}, function(modId) { var map = {"./BlockCipher":1666529690748,"../util":1666529690749}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690748, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0}),exports.BlockCipher=void 0,exports.BlockCipher=function(){},exports.BlockCipher.prototype.BLOCK_SIZE,exports.BlockCipher.prototype.encrypt,exports.BlockCipher.prototype.decrypt;
//# sourceMappingURL=BlockCipher.js.map
}, function(modId) { var map = {}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690749, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0}),exports.getWxVersion=exports.checkIsHuaWei=exports.checkIsIOS=exports.androidLaterThan7022=exports.checkIsAndroid=exports.arrayFill=exports.intIp2byte=exports.int2ip=exports.ip2int=exports.formatInetAddr=exports.parseInetAddr=exports.compareVersion=exports.noop=void 0;var qcloud_iotexplorer_appdev_sdk_1=require("qcloud-iotexplorer-appdev-sdk");function compareVersion(r,e){for(var t=r.split("."),n=e.split("."),o=Math.max(t.length,n.length);t.length<o;)t.push("0");for(;n.length<o;)n.push("0");for(var p=0;p<o;p++){var i=parseInt(t[p]),s=parseInt(n[p]);if(i>s)return 1;if(i<s)return-1}return 0}function parseInetAddr(r,e,t){for(var n="",o=0;o<t;o++)n+=String(255&r[e+o]),o!==t-1&&(n+=".");return n}function formatInetAddr(r){void 0===r&&(r="");for(var e=r.split("."),t=new Int8Array(e.length),n=0;n<e.length;n++){var o=parseInt(e[n]);t[n]=o>127?o-256:o}return t}function ip2int(r){var e=formatInetAddr(r);return 16777216*(255&e[0])+65536*(255&e[1])+256*(255&e[2])+(255&e[3])}function int2ip(r){return(r>>24&255)+"."+(r>>16&255)+"."+(r>>8&255)+"."+(255&r)}function intIp2byte(r){var e=[0,0,0,0];return e[0]=r>>24&255|0,e[1]=r>>16&255|0,e[2]=r>>8&255|0,e[3]=255&r|0,e}function arrayFill(r,e){for(var t=0;t<r.length;t++)r[t]=e}exports.noop=qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.noop,exports.compareVersion=compareVersion,exports.parseInetAddr=parseInetAddr,exports.formatInetAddr=formatInetAddr,exports.ip2int=ip2int,exports.int2ip=int2ip,exports.intIp2byte=intIp2byte,exports.arrayFill=arrayFill,exports.checkIsAndroid=function(){return wx.getSystemInfoSync().platform.indexOf("android")>-1},exports.androidLaterThan7022=function(){var r=exports.checkIsAndroid(),e=compareVersion(exports.getWxVersion(),"7.0.22")>=0;return r&&e},exports.checkIsIOS=function(){return wx.getSystemInfoSync().platform.indexOf("ios")>-1},exports.checkIsHuaWei=function(){return wx.getSystemInfoSync().brand.indexOf("HUAWEI")>-1},exports.getWxVersion=function(){return wx.getSystemInfoSync().version};
//# sourceMappingURL=util.js.map
}, function(modId) { var map = {}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690750, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=require("tslib");tslib_1.__exportStar(require("./TouchAES"),exports),tslib_1.__exportStar(require("./SimpleConfigAES"),exports);
//# sourceMappingURL=index.js.map
}, function(modId) { var map = {"./TouchAES":1666529690751,"./SimpleConfigAES":1666529690752}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690751, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0}),exports.TouchAES=void 0;var qcloud_iotexplorer_appdev_sdk_1=require("qcloud-iotexplorer-appdev-sdk"),CryptoJS=qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.CryptoJS,TouchAES=function(){function t(t,o,r,e){this.TRANSFORMATION_MODE_DEFAULT=CryptoJS.mode.ECB,this.TRANSFORMATION_PADDING_DEFAULT=CryptoJS.pad.Pkcs7,this.mKey=t,this.mIV=o,this.mTransformationMode=r||this.TRANSFORMATION_MODE_DEFAULT,this.mTransformationPadding=e||this.TRANSFORMATION_PADDING_DEFAULT}return t.prototype.encrypt=function(t){var o=CryptoJS.enc.Utf8.parse(this.mKey),r=CryptoJS.enc.Utf8.parse(this.mIV),e=CryptoJS.AES.encrypt(t,o,{iv:r,mode:this.mTransformationMode,padding:this.mTransformationPadding});return console.log("encrypted: "+e),e},t.prototype.decrypt=function(t){var o=CryptoJS.enc.Utf8.parse(this.mKey),r=CryptoJS.enc.Utf8.parse(this.mIV),e=CryptoJS.enc.Hex.parse(t),p=CryptoJS.enc.Base64.stringify(e),i=CryptoJS.AES.decrypt(p,o,{iv:r,mode:this.mTransformationMode,padding:this.mTransformationPadding});return console.log("decrypted: "+i.toString(CryptoJS.enc.Utf8)),i},t}();exports.TouchAES=TouchAES;
//# sourceMappingURL=TouchAES.js.map
}, function(modId) { var map = {}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690752, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0}),exports.SimpleConfigAES=void 0;var qcloud_iotexplorer_appdev_sdk_1=require("qcloud-iotexplorer-appdev-sdk"),AesCrypto_1=require("../crypto/AesCrypto"),byteUtil=qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.byteUtil;exports.SimpleConfigAES=function(e,r,t,o,i,p,n){var l=new AesCrypto_1.Aes(i),y=byteUtil.arrayCopy,s=6,d=r>>3,a=1,_=new Uint8Array(t),u=new Uint8Array(e),A=new Uint8Array(16),v=new Uint8Array(16);do{for(var c=a,U=0;U<r/8;U++)y(_,0,A,0,8),y(u,8*U,A,8,8),y(v=l.encrypt(A),0,_,0,8),_[7]^=c++,y(v,8,u,8*U,8);a+=d,--s}while(s);return y(_,0,n,0,8),y(u,0,n,8,u.length),byteUtil.convertUnit8s2Bytes(n),r+8};
//# sourceMappingURL=SimpleConfigAES.js.map
}, function(modId) { var map = {"../crypto/AesCrypto":1666529690747}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690753, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=require("tslib");tslib_1.__exportStar(require("./UDPSocketClient"),exports),tslib_1.__exportStar(require("./UDPSocketServer"),exports),tslib_1.__exportStar(require("./UDPSocket"),exports);
//# sourceMappingURL=index.js.map
}, function(modId) { var map = {"./UDPSocketClient":1666529690754,"./UDPSocketServer":1666529690755,"./UDPSocket":1666529690756}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690754, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0}),exports.UDPSocketClient=void 0;var tslib_1=require("tslib"),qcloud_iotexplorer_appdev_sdk_1=require("qcloud-iotexplorer-appdev-sdk"),util_1=require("../util"),delayPromise=function(e){return new Promise((function(t){setTimeout((function(){t()}),e)}))},UDPSocketClient=function(e){function t(t){var o=e.call(this)||this;return o.TAG="UDPSocketClient",o.dataQueue={},o.queueExcuteState={},o.checkIsSupport()&&(o.mSocket=wx.createUDPSocket(),o.mSocket.bind(t),o.isClose=!1,o.mSocket.onClose((function(){o.isClose=!0})),o.errorHandler=function(e){o.emit("udpSocketError",e)},o.mSocket.onError(o.errorHandler)),o}return tslib_1.__extends(t,e),t.prototype.checkIsSupport=function(){var e=wx.getSystemInfoSync().SDKVersion;return!(util_1.compareVersion(e,"2.7.0")<0)||(this.emit("udpSocketError","当前微信版本过低，无法使用udpsocket的功能，请升级到最新微信版本后重试。"),!1)},t.prototype.interrupt=function(){console.log(this.TAG,"USPSocketClient is interrupt"),this.close()},t.prototype.close=function(){this.isClose=!0,this.mSocket&&(this.mSocket.offError(this.errorHandler),this.mSocket.close(),this.mSocket=null)},t.prototype.sendDataSideBySide=function(e,t,o,s,r,i,n){var l=this;if(void 0===t&&(t=0),1===o||this.isClose)return!this.isClose&&this.mSocket.send({address:s,port:r,message:e[t]}),n();setTimeout((function(){var c=Math.min(e.length-1,t+1),u=c>=e.length-1?1:o-1;!l.isClose&&l.mSocket.send({address:s,port:r,message:e[t]}),l.sendDataSideBySide(e,c,u,s,r,i,n)}),i)},t.prototype.sendData=function(e,t,o,s,r,i){return void 0===t&&(t=0),tslib_1.__awaiter(this,void 0,void 0,(function(){var n;return tslib_1.__generator(this,(function(l){switch(l.label){case 0:if(!e||e.length<=0)return console.log(this.TAG,"sendData(): data == null or length <= 0"),[2];if(this.isClose)return console.log(this.TAG,"udpsocket is close"),[2];n=t,l.label=1;case 1:return n<Math.min(t+o,e.length)?(console.log("UDPSocketClient send",{address:s,port:r,message:e[n]}),this.mSocket.send({address:s,port:r,message:e[n]}),[4,delayPromise()]):[3,4];case 2:l.sent(),l.label=3;case 3:return n++,[3,1];case 4:return[4,qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.delay(i)];case 5:return l.sent(),[2]}}))}))},t}(qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.EventEmitter);exports.UDPSocketClient=UDPSocketClient;
//# sourceMappingURL=UDPSocketClient.js.map
}, function(modId) { var map = {"../util":1666529690749}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690755, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0}),exports.UDPSocketServer=void 0;var tslib_1=require("tslib"),qcloud_iotexplorer_appdev_sdk_1=require("qcloud-iotexplorer-appdev-sdk"),util_1=require("../util"),UDPSocketServer=function(e){function t(t,o,i){var r=e.call(this)||this;return r.TAG="UDPSocketServer",r.msgHandler=util_1.noop,r.mSocket=t,r.isClose=!1,r.mSocket.onClose((function(){r.interrupt()})),r.mTimeout=o,i&&(r.mCorrectLen=i),r}return tslib_1.__extends(t,e),t.prototype.startServer=function(){this.handlerTimeout(this.mTimeout),this.onListening(),this.onMessage(this.mCorrectLen)},t.prototype.handlerTimeout=function(e){var t=this;this.mSocketTimeoutTimer=setTimeout((function(){t.emit("timeout"),t.interrupt()}),e)},t.prototype.onMessage=function(e){var t=this;this.msgHandler=function(o){t.isClose||(console.log(t.TAG,"recieveMsg",o),t.emit("recieveMsg",o),!e||e&&o.remoteInfo.size===e?t.emit("recieveCorrectMsg",o):console.log(t.TAG,"received len is different from specific len"))},this.mSocket.onMessage(this.msgHandler)},t.prototype.onListening=function(){var e=this;this.mSocket.onListening((function(t){e.isClose||(e.emit("recieveMsg",t),console.log(e.TAG,"onListening",t))}))},t.prototype.interrupt=function(){console.log(this.TAG,"USPSocketServer is interrupt"),this.mSocket.offMessage(this.msgHandler),this.close()},t.prototype.close=function(){this.isClose=!0},t}(qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.EventEmitter);exports.UDPSocketServer=UDPSocketServer;
//# sourceMappingURL=UDPSocketServer.js.map
}, function(modId) { var map = {"../util":1666529690749}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690756, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0}),exports.UDPSocket=void 0;var tslib_1=require("tslib"),qcloud_iotexplorer_appdev_sdk_1=require("qcloud-iotexplorer-appdev-sdk"),UDPSocket=function(e){function t(t){var o=e.call(this)||this;o.isClose=!1,o.destroy=qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.noop,o.socket=wx.createUDPSocket(),console.log("udp socket bind on port",t||"random");try{o.socket.bind(t)}catch(e){o.emit("error",e)}var s=function(e){return o.emit("close",e)},r=function(e){return o.emit("error",e)},n=function(e){return o.emit("message",e)},i=function(e){return o.emit("listening",e)};return o.socket.onClose((function(e){return s(e)})),o.socket.onError((function(e){return r(e)})),o.socket.onMessage((function(e){return n(e)})),o.socket.onListening(i),o.destroy=function(){console.log("udp client destroy"),o.isClose=!0,o.socket.offClose(s),o.socket.offError(r),o.socket.offMessage(n),o.socket.offListening(i),o.socket.close()},o}return tslib_1.__extends(t,e),t.prototype.sendData=function(e){var t=e.address,o=e.port,s=e.message,r=e.offset,n=e.length,i=e.timeDelay;return tslib_1.__awaiter(this,void 0,void 0,(function(){var e=this;return tslib_1.__generator(this,(function(c){switch(c.label){case 0:return[4,new Promise((function(i,c){try{e.socket.send({address:t,port:o,message:s,offset:r,length:n}),i()}catch(e){c(e)}}))];case 1:return c.sent(),i?[4,qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.delay(i)]:[3,3];case 2:c.sent(),c.label=3;case 3:return[2]}}))}))},t.prototype.sendDataSideBySide=function(e){var t=this,o=e.address,s=e.port,r=e.data,n=void 0===r?[]:r,i=e.offset,c=e.length,a=e.timeDelay,d=e.callback;if(c<=0||this.isClose)return d();setTimeout((function(){t.socket.send({address:o,port:s,message:n[i]});var e=Math.min(n.length-1,i+1),r=e>=n.length?0:c-1;t.sendDataSideBySide({address:o,port:s,data:n,offset:e,length:r,timeDelay:a,callback:d})}),a)},t}(qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.EventEmitter);exports.UDPSocket=UDPSocket;
//# sourceMappingURL=UDPSocket.js.map
}, function(modId) { var map = {}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690757, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0}),exports.collectModuleLog=void 0;var tslib_1=require("tslib"),qcloud_iotexplorer_appdev_sdk_1=require("qcloud-iotexplorer-appdev-sdk"),constants_1=require("../constants"),UdpServer_1=require("./UdpServer"),wxApis_1=tslib_1.__importDefault(require("./wxApis")),util_1=require("./util"),MODULE_REPORT_AP_SSID="ESP-LOG-QUERY",MODULE_REPORT_AP_PASSWORD="86013388",MODULE_REPORT_AP_UDP_ADDRESS="192.168.4.1",MODULE_REPORT_AP_UDP_PORT="9876",MODULE_REPORT_AP_TIMEOUT=6e4,MODULE_REPORT_RETRY_TIMES=12,collectModuleLogInternal=function(e){var r=e.reporter,t=e.sdk;return tslib_1.__awaiter(void 0,void 0,void 0,(function(){var e,o,_,s,i,n,d;return tslib_1.__generator(this,(function(p){switch(p.label){case 0:return p.trys.push([0,,8,10]),e=Date.now(),r.info(constants_1.WifiConfStepCode.MODULE_REPORT_START),(o=util_1.checkIsAndroid())||qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.tips.showLoading("收集日志中"),r.info(constants_1.WifiConfStepCode.MODULE_REPORT_CONNECT_WIFI_START,{urgent:!0}),[4,wxApis_1.default.startWifi()];case 1:return p.sent(),[4,wxApis_1.default.connectWifi({SSID:MODULE_REPORT_AP_SSID,password:MODULE_REPORT_AP_PASSWORD})];case 2:return p.sent(),[4,wxApis_1.default.getConnectedWifi()];case 3:if(p.sent().wifi.SSID!==MODULE_REPORT_AP_SSID)throw{code:"WIFI_RECONNECT_FAIL"};o&&qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.tips.showLoading("收集日志中"),r.info(constants_1.WifiConfStepCode.MODULE_REPORT_CONNECT_WIFI_SUCCESS,{timeCost:Date.now()-e,shouldStopTemp:!0}),p.label=4;case 4:return p.trys.push([4,6,,7]),_=new UdpServer_1.UdpServer({address:MODULE_REPORT_AP_UDP_ADDRESS,port:MODULE_REPORT_AP_UDP_PORT,reporter:r,retryTime:MODULE_REPORT_RETRY_TIMES,retryGap:MODULE_REPORT_AP_TIMEOUT/MODULE_REPORT_RETRY_TIMES,messageNoParse:!0,sdk:t}),s=qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.genPromise(),i=qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.genPromise(),_.onError((function(e){return s.reject({code:"MODULE_REPORT_COMMUNICATE_AP_ERROR",detail:{errMsg:e}})})),_.onProgressError((function(e){return i.reject({code:"MODULE_REPORT_COMMUNICATE_AP_ERROR",detail:e})})),r.info(constants_1.WifiConfStepCode.MODULE_REPORT_COMMUNICATE_AP_START),[4,_.send({cmdType:3})];case 5:return n=p.sent(),r.info(constants_1.WifiConfStepCode.MODULE_REPORT_COMMUNICATE_AP_SUCCESS,{moudleDetail:n,timeCost:Date.now()-e}),[3,7];case 6:return d=p.sent(),r.error("MODULE_REPORT_COMMUNICATE_AP_ERROR",{error:d}),[3,7];case 7:return[3,10];case 8:return qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.tips.hideLoading(),[4,qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.delay(2e3)];case 9:return p.sent(),r.info(constants_1.WifiConfStepCode.MODULE_REPORT_COMMUNICATE_END,{shouldStopTemp:!1}),[7];case 10:return[2]}}))}))};exports.collectModuleLog=function(e){var r=e.reporter,t=e.doCollectModuleLog,o=void 0===t?collectModuleLogInternal:t,_=e.timeout,s=void 0===_?MODULE_REPORT_AP_TIMEOUT:_,i=e.sdk;return tslib_1.__awaiter(void 0,void 0,void 0,(function(){var e,t,_;return tslib_1.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),e=qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.genPromise(),setTimeout((function(){e.reject({code:"MODULE_REPORT_TIMEOUT"})}),s),[4,Promise.race([e.promise,o({reporter:r,sdk:i})])];case 1:return n.sent(),qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.tips.showModal({title:"上报设备端日志成功",content:"收集成功，已上报给工程师处理",confirmText:"我知道了",showCancel:!1}),[2,!0];case 2:return t=n.sent(),(_=t&&(t.errCode||t.code))&&(_ in constants_1.WifiConfErrorMsg||_ in constants_1.WifiConfErrorMsg)&&(t.uiMsg=constants_1.WifiConfErrorMsg[_]),r.error("MODULE_REPORT_FAIL",{error:t}),qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.tips.showModal({title:"上报设备端日志失败",content:t.uiMsg||constants_1.WifiConfErrorMsg.MODULE_REPORT_ERROR,confirmText:"我知道了",showCancel:!1}),[2,!1];case 3:return[2]}}))}))};
//# sourceMappingURL=moduleLog.js.map
}, function(modId) { var map = {"../constants":1666529690737,"./UdpServer":1666529690758,"./wxApis":1666529690759,"./util":1666529690749}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690758, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0}),exports.UdpServer=void 0;var tslib_1=require("tslib"),qcloud_iotexplorer_appdev_sdk_1=require("qcloud-iotexplorer-appdev-sdk"),decodeUdpMsg=function(e){var r=new Uint8Array(e),t=String.fromCharCode.apply(null,r);return decodeURIComponent(escape(t))},UdpServer=function(){function e(e){var r=this,t=e.address,s=e.port,o=e.sdk,n=e.retryTime,a=void 0===n?5:n,i=e.retryGap,d=void 0===i?2e3:i,l=e.failRetryGap,p=void 0===l?200:l,c=e.messageNoParse,u=void 0!==c&&c,_=e.retryWhenFail,h=void 0!==_&&_;Object.assign(this,{address:t,port:s,sdk:o,retryTime:a,retryGap:d,messageNoParse:u,retryWhenFail:h,failRetryGap:p});var f=this.socket=wx.createUDPSocket();f.bind(this.port);var v=function(e){return r._onErrorHandler(e)},g=function(e){return r._onMessageHandler(e)};f.onError(v),f.onMessage(g),this.destroy=function(){r.socket.offError(v),r.socket.offMessage(g),r.socket.close()}}return e.prototype._onErrorHandler=function(e){"function"==typeof this._errorHandler?this._errorHandler(e):console.warn("UdpServer unhandled error",e)},e.prototype._onMessageHandler=function(e){var r,t,s;try{if(this.messageNoParse){var o=decodeUdpMsg(e.message);return null===(r=this.sdk)||void 0===r||r.reporter.info("udp-on-message",{data:{message:o}}),void("function"==typeof this._msgHandler?this._msgHandler(o):console.warn("UdpServer unhandled msg",o))}var n=JSON.parse(decodeUdpMsg(e.message));null===(t=this.sdk)||void 0===t||t.reporter.info("udp-on-message",{data:{message:n}}),this._cmdTypeHandler(n)}catch(e){null===(s=this.sdk)||void 0===s||s.reporter.info("udp-parse-message-error",{error:e})}},e.prototype._cmdTypeHandler=function(e){var r,t=this,s=function(e){"function"==typeof t._msgHandler?t._msgHandler(e):console.warn("UdpServer unhandled msg",e)};switch(console.log("------",e),+e.cmdType){case 2:"Current_Error"===e.deviceReply?this._onProgressErrorHandler({code:"BUSINESS_DEVICE_ERROR",detail:e}):"Previous_Error"===e.deviceReply?null===(r=this.sdk)||void 0===r||r.reporter.info("softap-receive-prev-error",{data:{message:e}}):s(e);break;case 5:case 7:s(e)}},e.prototype._onProgressErrorHandler=function(e){"function"==typeof this._progressErrorHandler?this._progressErrorHandler(e):console.warn("UdpServer unhandled progress error",e)},e.prototype.onError=function(e){return this._errorHandler=e,this},e.prototype.onProgressError=function(e){return this._progressErrorHandler=e,this},e.prototype.onMessage=function(e){return this._msgHandler=e,this},e.prototype._send=function(e){"string"!=typeof e&&(e=JSON.stringify(e)),this.socket.send({address:this.address,port:this.port,message:e})},e.prototype.send=function(e,r){var t=this,s=(void 0===r?{}:r).validateResponse;return this.aborted=!1,new Promise((function(r,o){return tslib_1.__awaiter(t,void 0,void 0,(function(){var t,n,a,i,d,l,p,c=this;return tslib_1.__generator(this,(function(u){switch(u.label){case 0:u.trys.push([0,9,,10]),t=!0,n=0,a=0,this.onMessage((function(e){try{t=!1,(!s||"function"==typeof s&&!0===s(e))&&r(e)}catch(e){o(e)}})),i=function(){var r,t;null===(t=null===(r=c.sdk)||void 0===r?void 0:r.reporter)||void 0===t||t.info("udp-send-msg",{data:{msg:e,retryCount:n,failRetryCount:a}}),c._send(e)},u.label=1;case 1:return u.trys.push([1,2,,6]),i(),[3,6];case 2:return d=u.sent(),console.log("come handle udp error",a),this.retryWhenFail?(l=function(){return tslib_1.__awaiter(c,void 0,void 0,(function(){return tslib_1.__generator(this,(function(e){switch(e.label){case 0:console.log("retry send udp"),e.label=1;case 1:return e.trys.push([1,5,,7]),a<this.retryTime?[4,qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.delay(this.failRetryGap)]:[3,3];case 2:return e.sent(),a++,i(),[3,4];case 3:o(tslib_1.__assign({code:"UDP_SEND_MSG_FAIL"},d)),e.label=4;case 4:return[3,7];case 5:return e.sent(),[4,l()];case 6:return e.sent(),[3,7];case 7:return[2]}}))}))},[4,l()]):[3,4];case 3:return u.sent(),[3,5];case 4:o(tslib_1.__assign({code:"UDP_SEND_MSG_FAIL"},d)),u.label=5;case 5:return[3,6];case 6:return!this.aborted&&t&&n<=this.retryTime?[4,qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.delay(this.retryGap)]:[3,8];case 7:return u.sent(),this.aborted?[2,o(null)]:t?(n++,i(),[3,6]):[2];case 8:return this.aborted?[2,o(null)]:(o({code:"UDP_NOT_RESPONSE"}),[3,10]);case 9:return p=u.sent(),o(tslib_1.__assign({code:"UDP_SEND_MSG_FAIL"},p)),[3,10];case 10:return[2]}}))}))}))},e.prototype.abort=function(){this.aborted=!0},e}();exports.UdpServer=UdpServer;
//# sourceMappingURL=UdpServer.js.map
}, function(modId) { var map = {}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690759, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0});var qcloud_iotexplorer_appdev_sdk_1=require("qcloud-iotexplorer-appdev-sdk"),pifyApiArr=["startWifi","stopWifi","getSystemInfo","getConnectedWifi","connectWifi","getNetworkType","getWifiList"],callbackApiArr=["onGetWifiList","onNetworkStatusChange","offNetworkStatusChange","onAppShow","onAppHide"],wxApis={};pifyApiArr.forEach((function(e){wxApis[e]=function(i){return qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.pify(wx[e])(i)}})),callbackApiArr.forEach((function(e){wxApis[e]=function(i){return wx[e](i)}})),exports.default=wxApis;
//# sourceMappingURL=index.js.map
}, function(modId) { var map = {}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690760, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0}),exports.tryRequest=void 0;var tslib_1=require("tslib"),qcloud_iotexplorer_appdev_sdk_1=require("qcloud-iotexplorer-appdev-sdk");exports.tryRequest=function(e,r){var t=r.reporter;return tslib_1.__awaiter(void 0,void 0,void 0,(function(){var r;return tslib_1.__generator(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,7]),[4,e()];case 1:return[2,o.sent()];case 2:return r=o.sent(),t.info("wificonf-try-request-fail",{error:r}),r?r.errMsg&&/request:fail/.test(r.errMsg)?[4,qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.tips.confirm("手机无法正常访问网络","尝试更换手机Wi-Fi网络或切换到移动信号后重试",{confirmText:"重试",confirmColor:qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.constants.themeColorMap.primary,cancelText:"取消配网",cancelColor:qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.constants.themeColorMap.danger})]:[3,4]:[3,6];case 3:return o.sent()?(t.info("wificonf-retry-request"),[2,exports.tryRequest(e,{reporter:t})]):[2,Promise.reject(r)];case 4:return[4,qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.tips.confirm(qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.tips.getErrorMsg(r),"",{confirmText:"重试",confirmColor:qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.constants.themeColorMap.primary,cancelText:"取消",cancelColor:qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.constants.themeColorMap.danger})];case 5:if(o.sent())return t.info("wificonf-retry-request"),[2,exports.tryRequest(e,{reporter:t})];o.label=6;case 6:return[2,Promise.reject(r)];case 7:return[2]}}))}))};
//# sourceMappingURL=tryRequest.js.map
}, function(modId) { var map = {}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690761, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0}),exports.reconnectWifi=void 0;var tslib_1=require("tslib"),qcloud_iotexplorer_appdev_sdk_1=require("qcloud-iotexplorer-appdev-sdk"),constants_1=require("../constants"),connectWifiBase_1=require("./connectWifiBase"),wxApis_1=tslib_1.__importDefault(require("./wxApis")),util_1=require("./util"),delay=qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.delay,onNetworkStatusChange=function(){return new Promise((function(e,t){var o=Date.now();console.log("onNetworkStatusChange",o);var n=setTimeout((function(){wxApis_1.default.offNetworkStatusChange(s),wxApis_1.default.getNetworkType().then((function(n){console.log("getNetworkType",n),"none"===n.networkType?t({code:"BUSINESS_WIFI_RECONNECT_STATE_CHANGE_TIMEOUT"}):e(tslib_1.__assign(tslib_1.__assign({},n),{timeCost:Date.now()-o}))}))}),13e3),s=function(t){var i=t.isConnected;if(console.log("onNetWorkStatusChange",t),i){clearTimeout(n),wxApis_1.default.offNetworkStatusChange(s);var r=5e3-(Date.now()-o);console.log("onNetWorkStatusChange is connected",r),r<=0?e(tslib_1.__assign(tslib_1.__assign({},t),{timeCost:Date.now()-o})):delay(r).then((function(){e(tslib_1.__assign(tslib_1.__assign({},t),{timeCost:Date.now()-o}))}))}};wxApis_1.default.onNetworkStatusChange(s)}))};exports.reconnectWifi=function(e,t){var o=t.onProgress,n=t.ignoreError,s=void 0!==n&&n,i=t.useTargetWifi,r=void 0!==i&&i;return tslib_1.__awaiter(void 0,void 0,void 0,(function(){var t,n,i,_,a;return tslib_1.__generator(this,(function(c){switch(c.label){case 0:t=util_1.checkIsIOS(),n=Date.now(),c.label=1;case 1:return c.trys.push([1,9,11,12]),o({code:constants_1.WifiConfStepCode.SOFTAP_RECONNECT_TARGET_WIFI_START,reportEvents:["重连wifi"]}),i=void 0,r?[4,connectWifiBase_1.connectWifiBase(e)]:[3,3];case 2:return c.sent(),o({code:constants_1.WifiConfStepCode.SOFTAP_RECONNECT_TARGET_WIFI_SUCCESS,detail:{timeCost:Date.now()-n},reportEvents:["重连wifi"]}),[3,8];case 3:return c.trys.push([3,5,,8]),[4,onNetworkStatusChange()];case 4:return i=c.sent(),o({code:constants_1.WifiConfStepCode.SOFTAP_RECONNECT_TARGET_WIFI_SUCCESS,detail:{connectStatus:i,type:"SOFTAP_RECONNECT_TARGET_WIFI_USE_DEFAULT"},reportEvents:["重连wifi"]}),[3,8];case 5:return _=c.sent(),util_1.checkIsHuaWei()?[3,7]:(console.error(_),[4,connectWifiBase_1.connectWifiBase(e)]);case 6:c.sent(),o({code:constants_1.WifiConfStepCode.SOFTAP_RECONNECT_TARGET_WIFI_SUCCESS,detail:{timeCost:Date.now()-n},reportEvents:["重连wifi"]}),c.label=7;case 7:return[3,8];case 8:return[3,12];case 9:return a=c.sent(),console.error(a),[4,qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.tips.confirm("手机连接目标Wi-Fi“"+e.SSID+"”失败，请手动切换到能够正常访问的网络环境(移动网络或者WI-FI)后继续配网操作","",{confirmText:"继续",confirmColor:qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.constants.themeColorMap.primary,cancelText:"取消",cancelColor:qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.constants.themeColorMap.danger,enforce:!0})];case 10:return c.sent()||s?(o({code:constants_1.WifiConfStepCode.SOFTAP_RECONNECT_TARGET_WIFI_SUCCESS,detail:{ignoreError:s,timeCost:Date.now()-n}}),[3,12]):[2,Promise.reject(tslib_1.__assign(tslib_1.__assign({},a),{code:"BUSINESS_WIFI_RECONNECT_FAIL"}))];case 11:return t&&qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.tips.hideLoading(),[7];case 12:return[2]}}))}))};
//# sourceMappingURL=reconnectWifi.js.map
}, function(modId) { var map = {"../constants":1666529690737,"./connectWifiBase":1666529690762,"./wxApis":1666529690759,"./util":1666529690749}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690762, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0}),exports.connectWifiBase=void 0;var tslib_1=require("tslib"),wxApis_1=tslib_1.__importDefault(require("./wxApis")),util_1=require("./util"),qcloud_iotexplorer_appdev_sdk_1=require("qcloud-iotexplorer-appdev-sdk"),getConnectedWifi_1=require("./getConnectedWifi");exports.connectWifiBase=function(e){return tslib_1.__awaiter(void 0,void 0,void 0,(function(){var i,t,r,o,s;return tslib_1.__generator(this,(function(n){switch(n.label){case 0:return i=util_1.checkIsIOS(),[4,wxApis_1.default.startWifi()];case 1:n.sent(),t=!1,n.label=2;case 2:return n.trys.push([2,4,,5]),[4,getConnectedWifi_1.checkIsTargetWifi(e)];case 3:return t=n.sent(),[3,5];case 4:return r=n.sent(),console.error("checkIsTargetWifi error",r),[3,5];case 5:return t?(null===(s=null===(o=null==this?void 0:this.sdk)||void 0===o?void 0:o.reporter)||void 0===s||s.info("CONNECT_WIFI_AUTO, wifi已经自动连接"),[2]):(i&&qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.tips.showLoading("WiFi连接中",""),[4,wxApis_1.default.connectWifi({SSID:e.SSID,password:e.password,forceNewApi:!0,complete:function(e){console.log("connectWifi fail complete",e)}})]);case 6:return n.sent(),i&&qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.tips.hideLoading(),[2]}}))}))};
//# sourceMappingURL=connectWifiBase.js.map
}, function(modId) { var map = {"./wxApis":1666529690759,"./util":1666529690749,"./getConnectedWifi":1666529690763}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690763, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0}),exports.checkIsTargetWifi=exports.getConnectedWifi=void 0;var tslib_1=require("tslib"),wxApis_1=tslib_1.__importDefault(require("./wxApis"));exports.getConnectedWifi=function(){return tslib_1.__awaiter(void 0,void 0,void 0,(function(){var e,i,t;return tslib_1.__generator(this,(function(r){switch(r.label){case 0:return[4,wxApis_1.default.getConnectedWifi()];case 1:return e=r.sent().wifi,null===(t=null===(i=null==this?void 0:this.sdk)||void 0===i?void 0:i.reporter)||void 0===t||t.info("CONNECTED_WIFI_INFO",{detail:JSON.stringify(e)}),[2,e]}}))}))},exports.checkIsTargetWifi=function(e){return tslib_1.__awaiter(void 0,void 0,void 0,(function(){var i;return tslib_1.__generator(this,(function(t){switch(t.label){case 0:return[4,exports.getConnectedWifi()];case 1:return i=t.sent(),[2,(null==e?void 0:e.SSID)===(null==i?void 0:i.SSID)]}}))}))};
//# sourceMappingURL=getConnectedWifi.js.map
}, function(modId) { var map = {"./wxApis":1666529690759}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690764, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0}),exports.connectWifi=void 0;var tslib_1=require("tslib"),qcloud_iotexplorer_appdev_sdk_1=require("qcloud-iotexplorer-appdev-sdk"),connectWifiBase_1=require("./connectWifiBase"),constants_1=require("../constants");exports.connectWifi=function(e,o){var t=o.onProgress;return tslib_1.__awaiter(void 0,void 0,void 0,(function(){var o,r;return tslib_1.__generator(this,(function(n){switch(n.label){case 0:t({code:constants_1.WifiConfStepCode.CONNECT_WIFI_START}),o=Date.now(),n.label=1;case 1:return n.trys.push([1,3,,5]),[4,connectWifiBase_1.connectWifiBase(e)];case 2:return n.sent(),t({code:constants_1.WifiConfStepCode.CONNECT_WIFI_SUCCESS,detail:{timeCost:Date.now()-o}}),[3,5];case 3:return r=n.sent(),console.error("connectWifi error",r),[4,qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.tips.confirm('手机连接目标Wi-Fi"'+e.SSID+'"失败，请手动切换后继续配网操作',"",{confirmText:"继续",confirmColor:qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.constants.themeColorMap.primary,cancelText:"取消",cancelColor:qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.constants.themeColorMap.danger,enforce:!0})];case 4:return n.sent()?(t({code:constants_1.WifiConfStepCode.CONNECT_WIFI_MANUAL,detail:{timeCost:Date.now()-o}}),[3,5]):[2,Promise.reject(tslib_1.__assign(tslib_1.__assign({},r),{code:"CONNECT_WIFI_FAIL"}))];case 5:return[2]}}))}))};
//# sourceMappingURL=connectWifi.js.map
}, function(modId) { var map = {"./connectWifiBase":1666529690762,"../constants":1666529690737}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690765, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0}),exports.pollRequest=void 0;var tslib_1=require("tslib"),qcloud_iotexplorer_appdev_sdk_1=require("qcloud-iotexplorer-appdev-sdk"),tryRequest_1=require("./tryRequest"),DEFAULT_MAX_QUERY_TIMES=20,DEFAULT_MAX_IGNORE_ERROR_TIMES=20,DEFAULT_QUERY_GAP=2e3,resolveParams=function(e){var r=e.maxQueryTimes||DEFAULT_MAX_QUERY_TIMES,t=e.maxIgnoreErrorTimes||DEFAULT_MAX_IGNORE_ERROR_TIMES,s=e.queryGap||DEFAULT_QUERY_GAP;if(r=Math.max(r,t),t=Math.min(r,t),"function"!=typeof e.request)throw new Error("PollRequestProps request must be a function");return tslib_1.__assign(tslib_1.__assign({},e),{maxQueryTimes:r,maxIgnoreErrorTimes:t,queryGap:s})};exports.pollRequest=function(e){return tslib_1.__awaiter(this,void 0,void 0,(function(){var r,t,s,o,u,_,i,l,a,n,p;return tslib_1.__generator(this,(function(c){switch(c.label){case 0:r=resolveParams(e),t=r.maxQueryTimes,s=r.maxIgnoreErrorTimes,o=r.queryGap,u=r.request,_=r.checkResp,i=r.reporter,l=0,a=0,c.label=1;case 1:if(qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.logger.debug("poll request retryTime",l),qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.logger.debug("poll request errorTime",a),console.log("poll request time",l,a),!(a<s))return[3,7];c.label=2;case 2:return c.trys.push([2,4,,6]),[4,u()];case 3:return n=c.sent(),l++,[3,6];case 4:return p=c.sent(),a++,console.error("ignore request method error",p),[4,qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.delay(o)];case 5:return c.sent(),[3,1];case 6:return[3,9];case 7:return[4,tryRequest_1.tryRequest((function(){return u()}),{reporter:i})];case 8:n=c.sent(),l++,c.label=9;case 9:if(n&&("function"!=typeof _||!0===_(n)))return[3,11];if(l>=t)throw{code:"POLL_REQUEST_TIMEOUT"};return[4,qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.delay(o)];case 10:return c.sent(),[3,1];case 11:return[2,n]}}))}))};
//# sourceMappingURL=pollRequest.js.map
}, function(modId) { var map = {"./tryRequest":1666529690760}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690766, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=require("tslib");tslib_1.__exportStar(require("./WifiConfProtocolBase"),exports),tslib_1.__exportStar(require("./queryTokenStateAndBind"),exports),tslib_1.__exportStar(require("./issueHandler"),exports);
//# sourceMappingURL=index.js.map
}, function(modId) { var map = {"./WifiConfProtocolBase":1666529690767,"./queryTokenStateAndBind":1666529690769,"./issueHandler":1666529690768}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690767, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0}),exports.WifiConfProtocolBase=void 0;var tslib_1=require("tslib"),qcloud_iotexplorer_appdev_sdk_1=require("qcloud-iotexplorer-appdev-sdk"),constants_1=require("../constants"),utils_1=require("../utils"),issueHandler_1=require("./issueHandler"),queryTokenStateAndBind_1=require("./queryTokenStateAndBind"),WifiConfProtocolBase=function(e){function o(o,t){var s=e.call(this)||this;return s.connectAborted=!1,s.options={udpPort:8266,stepInterval:1e3,familyId:"default",autoRetry:!1,autoBind:!0},s.sdk=o,Object.assign(s.options,t),s}return tslib_1.__extends(o,e),o.prototype.onProgress=function(e){"function"==typeof this.options.onProgress&&this.options.onProgress(e)},o.prototype.onComplete=function(e){"function"==typeof this.options.onComplete&&this.options.onComplete(e)},o.prototype.onError=function(e){"function"==typeof this.options.onError&&this.options.onError(e)},o.prototype.start=function(e){var o=(void 0===e?{}:e).doNotRetry,t=void 0!==o&&o;return tslib_1.__awaiter(this,void 0,void 0,(function(){var e,o,s,r,n,i,d,a,c,p,u,_=this;return tslib_1.__generator(this,(function(l){switch(l.label){case 0:this.onProgress({code:constants_1.WifiConfStepCode.WIFI_CONF_START}),e=this.options.targetWifiInfo,o=e.SSID,s=e.BSSID,r=e.password,this.onProgress({code:constants_1.WifiConfStepCode.PROTOCOL_START,detail:{SSID:o,password:r},reportEvents:["配网","发送wifi"]}),l.label=1;case 1:l.trys.push([1,7,,10]),n=Date.now(),i=void 0,l.label=2;case 2:return l.trys.push([2,4,,5]),[4,this.doProtocol({SSID:o,BSSID:s,password:r})];case 3:return d=l.sent(),i=d?d.address:null,[3,5];case 4:throw a=l.sent(),console.error(a),tslib_1.__assign({code:"PROTOCOL_FAIL"},a);case 5:if(!i)throw{code:"PROTOCOL_INVALID_RESPONSE"};return this.onProgress({code:constants_1.WifiConfStepCode.PROTOCOL_SUCCESS,detail:{data:{address:i},timeCost:Date.now()-n},reportEvents:["发送wifi"]}),[4,this.doBusiness({address:i})];case 6:return c=l.sent(),this.onProgress({code:constants_1.WifiConfStepCode.WIFI_CONF_SUCCESS,detail:tslib_1.__assign({timeCost:Date.now()-n},c),reportEvents:["配网"]}),this.onComplete(c),[3,10];case 7:return p=l.sent(),console.error(p),p&&p.code in constants_1.WifiConfErrorMsg&&(p.uiMsg=constants_1.WifiConfErrorMsg[p.code]),t||!this.options.autoRetry?[3,9]:[4,issueHandler_1.issueHandler({error:p,targetWifiInfo:this.options.targetWifiInfo,wifiConfType:this.options.wifiConfType,onProgress:function(e){_.onProgress.call(_,e)}})];case 8:if(u=l.sent(),console.log("handle udp error, isHandled: "+u),u)return this.onProgress({code:constants_1.WifiConfStepCode.WIFI_CONF_AUTO_RETRY}),[2,this.start({doNotRetry:!0})];l.label=9;case 9:return this.connectAborted=!0,this.onProgress({code:constants_1.WifiConfStepCode.WIFI_CONF_FAIL,detail:{error:p}}),this.onError({code:"WIFI_CONF_FAIL",detail:{error:p}}),[3,10];case 10:return[2]}}))}))},o.prototype.doProtocol=function(e){throw new Error("子类必须自行实现自己协议传输逻辑")},o.prototype.doBusiness=function(e){var o=e.address;return tslib_1.__awaiter(this,void 0,void 0,(function(){var e,t,s,r,n,i,d=this;return tslib_1.__generator(this,(function(a){switch(a.label){case 0:return this.onProgress({code:constants_1.WifiConfStepCode.BUSINESS_START}),this.onProgress({code:constants_1.WifiConfStepCode.CREATE_UDP_CONNECTION_START,reportEvents:["udp"]}),e=Date.now(),t=new utils_1.UdpServer({address:o,port:this.options.udpPort,sdk:this.sdk}),s=qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.genPromise(),r=qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.genPromise(),t.onError((function(e){return s.reject({code:"UDP_ERROR",errMsg:e})})),t.onProgressError((function(e){return r.reject({code:"BUSINESS_DEVICE_ERROR",message:e})})),n=function(){return tslib_1.__awaiter(d,void 0,void 0,(function(){var o,s,r,n,i,d,a,c=this;return tslib_1.__generator(this,(function(p){switch(p.label){case 0:return p.trys.push([0,7,,8]),o=function(e){return tslib_1.__awaiter(c,void 0,void 0,(function(){return tslib_1.__generator(this,(function(o){switch(o.label){case 0:return[4,qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.delay(e||this.options.stepInterval)];case 1:return o.sent(),this.connectAborted&&qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.logger.debug("connection aborted"),[2]}}))}))},[4,o()];case 1:return p.sent(),s="2.0",r={},console.log("getDeviceExtendInfo",this.options.getDeviceExtendInfo),"function"!=typeof this.options.getDeviceExtendInfo?[3,3]:[4,this.options.getDeviceExtendInfo({udpServer:t})];case 2:r=p.sent(),p.label=3;case 3:return[4,t.send(tslib_1.__assign({cmdType:0,token:this.options.wifiConfToken},r),{validateResponse:function(e){return console.log("cmdType",e.cmdType),2==+e.cmdType}})];case 4:return n=p.sent(),this.onProgress({code:constants_1.WifiConfStepCode.CREATE_UDP_CONNECTION_SUCCESS,detail:{data:n,timeCost:Date.now()-e,protoVersion:s},reportEvents:["udp"]}),t.destroy(),[4,o()];case 5:return p.sent(),i=n.productId,d=n.deviceName,[4,queryTokenStateAndBind_1.queryTokenStateAndBind({token:this.options.wifiConfToken,productId:i,deviceName:d,familyId:this.options.familyId,roomId:this.options.roomId,onProgress:function(e){c.onProgress.call(c,e)},sdk:this.sdk,newTokenVersion:this.options.newTokenVersion})];case 6:return p.sent(),[2,{productId:i,deviceName:d}];case 7:throw a=p.sent(),t.destroy(),a;case 8:return[2]}}))}))},[4,Promise.race([n(),s.promise,r.promise])];case 1:return i=a.sent(),this.onProgress({code:constants_1.WifiConfStepCode.BUSINESS_SUCCESS,detail:{response:i},reportEvents:["addDevice"]}),[2,i]}}))}))},o}(qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.EventEmitter);exports.WifiConfProtocolBase=WifiConfProtocolBase;
//# sourceMappingURL=WifiConfProtocolBase.js.map
}, function(modId) { var map = {"../constants":1666529690737,"../utils":1666529690743,"./issueHandler":1666529690768,"./queryTokenStateAndBind":1666529690769}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690768, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0}),exports.issueHandler=void 0;var tslib_1=require("tslib"),qcloud_iotexplorer_appdev_sdk_1=require("qcloud-iotexplorer-appdev-sdk"),constants_1=require("../constants"),wxApis_1=tslib_1.__importDefault(require("../utils/wxApis")),utils_1=require("../utils"),delay=qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.delay,UDP_ERROR_WAIT_RETRY_TIME=1500,WIFI_CONNECT_WAIT_RETRY_TIME=4e3,handleWifiIssue=function(e){var t=e.error,r=e.targetWifiInfo,s=e.onProgress;return tslib_1.__awaiter(void 0,void 0,void 0,(function(){var e,o,i,n,_,a,c,d;return tslib_1.__generator(this,(function(l){switch(l.label){case 0:s({code:constants_1.WifiConfStepCode.AUTO_HANDLE_WIFI_PROBLEM_START,detail:{targetWifiInfo:r}}),l.label=1;case 1:return l.trys.push([1,12,,13]),e=t.code,o=void 0===e?" ":e,i=t.errMsg,n=void 0===i?"":i,utils_1.checkIsIOS()?new RegExp(/no route to host/i).test(n)?[4,qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.tips.showModal({title:"需要先开启微信本地网络权限才能继续配网",confirmText:"去开启",confirmColor:qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.constants.themeColorMap.primary,cancelText:"取消",cancelColor:qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.constants.themeColorMap.danger})]:[3,7]:[3,7];case 2:return l.sent()?[3,3]:[2,!1];case 3:return l.trys.push([3,6,,7]),[4,wxApis_1.default.getWifiList()];case 4:return l.sent(),[4,new Promise((function(e){wxApis_1.default.onAppShow((function(){e(!0)}))}))];case 5:return l.sent(),s({code:constants_1.WifiConfStepCode.AUTO_HANDLE_WIFI_NO_ROUTE,detail:{msg:"处理用户本地网络设置开关没打开的情况"}}),[2,!0];case 6:return _=l.sent(),console.log("handle no route error fail",_),[2,!1];case 7:return[4,wxApis_1.default.getConnectedWifi()];case 8:return(a=l.sent().wifi)&&a.SSID===r.SSID?"UDP_SEND_MSG_FAIL"!==o&&"UDP_ERROR"!==o?[3,10]:[4,delay(UDP_ERROR_WAIT_RETRY_TIME)]:[3,11];case 9:return l.sent(),s({code:constants_1.WifiConfStepCode.AUTO_HANDLE_WIFI_PROBLEM_SUCCESS,detail:{msg:"UDP错误，或许是连接wifi的延迟，直接重试下"}}),[2,!0];case 10:return s({code:constants_1.WifiConfStepCode.AUTO_HANDLE_WIFI_PROBLEM_CANCEL,detail:{msg:"当前连接的wifi正确，不需要处理"}}),[2,!1];case 11:return[3,13];case 12:return c=l.sent(),console.error("getConnectedWifi failed",c),c.errCode&&12010!==c.errCode?(s({code:constants_1.WifiConfStepCode.AUTO_HANDLE_WIFI_PROBLEM_CANCEL,detail:tslib_1.__assign({msg:"获取当前连接的wifi出错 "},c)}),[2,!1]):[3,13];case 13:return l.trys.push([13,17,,19]),[4,wxApis_1.default.startWifi()];case 14:return l.sent(),[4,wxApis_1.default.connectWifi({SSID:r.SSID,password:r.password})];case 15:return l.sent(),[4,delay(WIFI_CONNECT_WAIT_RETRY_TIME)];case 16:return l.sent(),s({code:constants_1.WifiConfStepCode.AUTO_HANDLE_WIFI_PROBLEM_SUCCESS,detail:{handled:!0}}),[2,!0];case 17:return d=l.sent(),console.error(d),qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.logger.debug("connectWifi fail",d),[4,qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.tips.showModal({title:"手机连接"+r.SSID+"失败，请在设置页面手动切换到"+r.SSID+"再继续",confirmText:"继续",confirmColor:qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.constants.themeColorMap.primary,cancelText:"取消",cancelColor:qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.constants.themeColorMap.danger})];case 18:return l.sent()?(s({code:constants_1.WifiConfStepCode.AUTO_HANDLE_WIFI_PROBLEM_SUCCESS,detail:{msg:"自动连接的wifi错误，用户设置自动连接"}}),[2,!0]):(s({code:constants_1.WifiConfStepCode.AUTO_HANDLE_WIFI_PROBLEM_CANCEL,detail:{msg:"自动连接的wifi错误，用户取消自动连接"}}),[2,!1]);case 19:return[2]}}))}))};exports.issueHandler=function(e){var t=e.error,r=e.targetWifiInfo,s=e.wifiConfType,o=e.onProgress,i=e.softAPInfo;return tslib_1.__awaiter(void 0,void 0,void 0,(function(){var e;return tslib_1.__generator(this,(function(n){switch(n.label){case 0:switch(e=!1,t.code){case"PROTOCOL_TIMEOUT":case"CONNECT_SMARTCONFIG_FAIL":return[3,1];case"UDP_ERROR":case"UDP_SEND_MSG_FAIL":return[3,3]}return[3,9];case 1:return"SoftAp"===s?[3,3]:[4,handleWifiIssue({error:t,targetWifiInfo:r,onProgress:o})];case 2:e=n.sent(),n.label=3;case 3:return"SoftAp"!==s?[3,6]:i?[4,handleWifiIssue({error:t,targetWifiInfo:i,onProgress:o})]:[3,5];case 4:e=n.sent(),n.label=5;case 5:return[3,8];case 6:return[4,handleWifiIssue({error:t,targetWifiInfo:r,onProgress:o})];case 7:e=n.sent(),n.label=8;case 8:case 9:return[3,10];case 10:return[2,e]}}))}))};
//# sourceMappingURL=issueHandler.js.map
}, function(modId) { var map = {"../constants":1666529690737,"../utils/wxApis":1666529690759,"../utils":1666529690743}; return __REQUIRE__(map[modId], modId); })
__DEFINE__(1666529690769, function(require, module, exports) {
Object.defineProperty(exports,"__esModule",{value:!0}),exports.queryTokenStateAndBind=void 0;var tslib_1=require("tslib"),qcloud_iotexplorer_appdev_sdk_1=require("qcloud-iotexplorer-appdev-sdk"),constants_1=require("../constants"),utils_1=require("../utils"),getBindState=function(e,t){return e.requestApi("AppGetDeviceBindTokenState",{Token:t},{isTokenApi:!0})},getMultiBindState=function(e,t){return e.requestApi("AppGetMultiDeviceBindTokenState",{Token:t},{isTokenApi:!0})};function queryTokenStateAndBind(e){var t,r,o,n,i,d=e.token,s=e.productId,u=e.deviceName,a=e.familyId,c=e.roomId,l=e.onProgress,_=e.sdk,p=e.skipBind,S=void 0!==p&&p,v=e.newTokenVersion,E=void 0!==v&&v;return tslib_1.__awaiter(this,void 0,void 0,(function(){var e,p,v,I,T,k,D,N;return tslib_1.__generator(this,(function(m){switch(m.label){case 0:e=E?"v3.0":"v2.0",p=Date.now(),l({code:constants_1.WifiConfStepCode.BUSINESS_QUERY_TOKEN_STATE_START,detail:{data:{Token:d}},reportEvents:["queryToken"]}),m.label=1;case 1:return m.trys.push([1,6,,7]),console.log("protoVersion ",e,"newTokenVersion",E),E?[4,utils_1.pollRequest({request:function(){return getMultiBindState(_,d)},checkResp:function(e){var t;console.log("checkrespv3",e);var r=e.Data;return!(!r||!Array.isArray(r))&&2===(null===(t=r[0])||void 0===t?void 0:t.State)},reporter:_.reporter,maxIgnoreErrorTimes:15})]:[3,3];case 2:if(I=m.sent(),null==(v=I.Data)?void 0:v[0]){try{s===(null===(t=v[0])||void 0===t?void 0:t.ProductId)&&u===(null===(r=v[0])||void 0===r?void 0:r.DeviceName)||null===(o=null==_?void 0:_.reporter)||void 0===o||o.info("QUERY_TOKEN_DEVICE_INFO_INCORRECT",{data:tslib_1.__assign({productIdFromDeviceReport:s,deviceNameFromDeviceReport:u},v[0])})}catch(e){console.error(e)}s=null===(n=v[0])||void 0===n?void 0:n.ProductId,u=null===(i=v[0])||void 0===i?void 0:i.DeviceName}return[3,5];case 3:return[4,utils_1.pollRequest({request:function(){return getBindState(_,d)},checkResp:function(e){return 2===e.State},reporter:_.reporter,maxIgnoreErrorTimes:15})];case 4:if(I=m.sent(),!(s&&u||(T=I.ProductId,k=I.DeviceName,s=T,u=k,T)))throw{code:"BUSINESS_QUERY_PRODUCTID_NOT_FOUND"};m.label=5;case 5:return[3,7];case 6:throw(D=m.sent())&&"POLL_REQUEST_TIMEOUT"===D.code?{code:"BUSINESS_QUERY_BIND_TOKEN_TIMEOUT"}:{code:"BUSINESS_QUERY_BIND_TOKEN_FAIL",detail:D,msg:qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.tips.getErrorMsg(D),reqId:null==D?void 0:D.reqId};case 7:if(l({code:constants_1.WifiConfStepCode.BUSINESS_QUERY_TOKEN_STATE_SUCCESS,detail:{protoVersion:e,timeCost:Date.now()-p},reportEvents:["queryToken"]}),console.log("new tokenVersion query token come to return"),S||E)return[2,{productId:s,deviceName:u}];l({code:constants_1.WifiConfStepCode.BUSINESS_ADD_DEVICE_START,detail:{data:{Token:d,ProductId:s,DeviceName:u,FamilyId:a,RoomId:c},protoVersion:e},reportEvents:["addDevice"]}),m.label=8;case 8:return m.trys.push([8,10,,11]),[4,utils_1.tryRequest((function(){return _.requestApi("AppTokenBindDeviceFamily",{FamilyId:a,ProductId:s,DeviceName:u,Token:d,RoomId:c},{isTokenApi:!0})}),{reporter:_.reporter})];case 9:return m.sent(),[3,11];case 10:return N=m.sent(),[2,Promise.reject({code:"BUSINESS_ADD_DEVICE_FAIL",detail:N,msg:qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.tips.getErrorMsg(N),reqId:N.reqId})];case 11:return l({code:constants_1.WifiConfStepCode.BUSINESS_ADD_DEVICE_SUCCESS}),[2,{productId:s,deviceName:u}]}}))}))}exports.queryTokenStateAndBind=queryTokenStateAndBind;
//# sourceMappingURL=queryTokenStateAndBind.js.map
}, function(modId) { var map = {"../constants":1666529690737,"../utils":1666529690743}; return __REQUIRE__(map[modId], modId); })
return __REQUIRE__(1666529690736);
})()
//# sourceMappingURL=index.js.map