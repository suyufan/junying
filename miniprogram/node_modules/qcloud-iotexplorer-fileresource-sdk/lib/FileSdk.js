"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=require("tslib"),FileSdk=function(){function e(e){var t=this;this.sdk=e,this.request=function(e,r){return t.sdk.requestTokenApi?t.sdk.requestTokenApi(e,r):t.sdk.requestApi(e,r)}}return e.prototype.getResourceUploadURL=function(e,t,r){return tslib_1.__awaiter(this,void 0,void 0,(function(){return tslib_1.__generator(this,(function(s){try{return[2,this.request("AppGetResourceUploadURL",{ProductId:r,UserResourceName:t,FileSize:e.size,ResourceVer:"0.0.1",ReadProtect:1})]}catch(e){console.log("AppGetResourceUploadURL错误")}return[2]}))}))},e.prototype.createResource=function(e,t,r){return tslib_1.__awaiter(this,void 0,void 0,(function(){return tslib_1.__generator(this,(function(s){return[2,this.request("AppCreateProductResource",{ProductId:r,UserResourceName:t,FileSize:e.size,ResourceVer:"0.0.1",FileHash:t,ResourceType:"FILE",ReadProtect:1})]}))}))},e.prototype.getDeviceResource=function(e,t){var r=this,s=Date.now()/1e3,i="";return new Promise((function(o){return tslib_1.__awaiter(r,void 0,void 0,(function(){var r,n,u,c=this;return tslib_1.__generator(this,(function(a){switch(a.label){case 0:r=Date.now()/1e3,n={DeviceId:t,ResourceName:e},a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.request("AppDescribeDeviceResource",n)];case 2:return i=a.sent().Resource,[3,4];case 3:return a.sent(),[3,4];case 4:return i?o(i):u=setInterval((function(){return tslib_1.__awaiter(c,void 0,void 0,(function(){return tslib_1.__generator(this,(function(e){switch(e.label){case 0:r=Date.now()/1e3,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.request("AppDescribeDeviceResource",n)];case 2:return i=e.sent().Resource,[3,4];case 3:return e.sent(),[3,4];case 4:return(i||r-s>36)&&(clearInterval(u),o(i)),[2]}}))}))}),5e3),[2]}}))}))}))},e.prototype.controlDeviceResource=function(e,t){return tslib_1.__awaiter(this,void 0,void 0,(function(){var r;return tslib_1.__generator(this,(function(s){switch(s.label){case 0:return r={DeviceId:t,ResourceName:e,ResourceVer:"0.0.1",Method:"update"},[4,this.request("AppControlDeviceResource",r)];case 1:return s.sent(),[2]}}))}))},e}();exports.default=FileSdk;
//# sourceMappingURL=FileSdk.js.map