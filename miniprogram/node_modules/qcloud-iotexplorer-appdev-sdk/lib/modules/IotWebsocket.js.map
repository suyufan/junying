{"version":3,"sources":["../../src/modules/IotWebsocket.ts"],"names":["event_emitter_for_miniprogram_1","tslib_1","__importDefault","require","shortid_for_miniprogram_1","utils_1","defaultOptions","url","heartbeatInterval","IotWebsocket","_super","sdk","options","_this","call","this","requestHandlerMap","Map","Object","assign","_connected","_subscribeDeviceIdList","_heartBeatTimer","__extends","prototype","isConnected","doConnectWs","_doConnectWsPromise","Promise","resolve","reject","__awaiter","onError","error","emit","disconnect","reporter","ws","WebSocket","appendParams","uin","_debug","_defaultUin","loginManager","userId","onOpen","logger","debug","info","onMessage","_a","data","JSON","parse","e","warn","push","reqId","has","get","onClose","event","err","connect","deviceIdList","checkLogin","sent","length","activePush","close","clearInterval","send","action","params","default","startTime_1","Date","now","stringify","reportData_1","reqBody","cutoffLong","timeCost","race","set","error_message","__assign","resBody","websocketStatus_1","code","msg","setTimeout","_b","error_1","delete","sendWsHeatBeat","requestOpts","Action","ActionParams","Platform","_apiPlatform","RequestId","AccessToken","accessToken","DeviceIds","isLogin","appKey","join","RegionId","_apiRegionId","AppKey","setInterval","exports"],"mappings":"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"}