"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=require("tslib"),constants_1=require("../constants"),pify_1=require("./pify"),utillib_1=require("./utillib"),codeReg=/\((\d+)\).+/;exports.default={showModal:function(t){return tslib_1.__awaiter(this,void 0,void 0,(function(){return tslib_1.__generator(this,(function(i){switch(i.label){case 0:return this.hideToast(),[4,pify_1.pify(wx.showModal)(tslib_1.__assign({confirmColor:constants_1.themeColorMap.primary,cancelColor:constants_1.themeColorMap.weak},t)).then((function(t){return!!t.confirm})).catch((function(){return!1}))];case 1:return[2,i.sent()]}}))}))},hideModal:function(){return this.hideToast()},alert:function(t,i){return void 0===i&&(i={}),tslib_1.__awaiter(this,void 0,void 0,(function(){return tslib_1.__generator(this,(function(e){switch(e.label){case 0:return[4,this.showModal(Object.assign({content:t,showCancel:!1},i))];case 1:return[2,"boolean"==typeof e.sent()]}}))}))},confirm:function(t,i,e){return void 0===i&&(i=""),void 0===e&&(e={}),tslib_1.__awaiter(this,void 0,void 0,(function(){return tslib_1.__generator(this,(function(n){return[2,this.showModal(Object.assign({title:t,content:i},e))]}))}))},showLoading:function(t,i){return void 0===t&&(t="加载中…"),t.endsWith("…")||t.endsWith("...")||(t+="…"),pify_1.pify(wx.showLoading)(tslib_1.__assign({title:t},i))},showInfo:function(t,i){void 0===i&&(i={});var e=i.duration,n=void 0===e?1500:e,r=tslib_1.__rest(i,["duration"]);return this.show(tslib_1.__assign({title:t,mode:"none",duration:n},r))},showError:function(t,i){return tslib_1.__awaiter(this,void 0,void 0,(function(){var e;return tslib_1.__generator(this,(function(n){return(null==t?void 0:t.errMsg)&&/cancel/.test(t.errMsg)?[2]:(this.hideToast(),e="",t&&(e=this.getErrorMsg(t,i))?[2,this.showInfo(e,tslib_1.__assign(tslib_1.__assign({},i),{duration:3e3}))]:[2])}))}))},getErrorMsg:function(t,i){var e=void 0===i?{}:i,n=e.defaultMsg,r=void 0===n?"":n,s=e.errMsgKey,o=void 0===s?"msg":s;return function(){if(t){var i="";return"string"==typeof t?t:(console.log(t,t.stack),utillib_1.isPlainObject(t)&&(i=t[o]||t.Message||t.msg||t.message||t.errMsg||"连接服务器失败，请稍后再试",t.reqId?i+="("+t.reqId+")":t.code&&!codeReg.test(i)&&(i+="("+t.code+")")),i||(i=r||"连接服务器失败，请稍后再试"),i)}}()},show:function(t){var i=t.text,e=t.title,n=t.icon,r=t.image,s=t.duration,o=t.mask,a=t.mode,u=t.waitForHide,c=void 0!==u&&u;if(!n&&a&&(n=a),i&&!e&&(e=i),wx.showToast({title:e,icon:n,image:r,duration:s,mask:o}),c)return utillib_1.delay(s)},hide:function(){return tslib_1.__awaiter(this,void 0,void 0,(function(){return tslib_1.__generator(this,(function(t){switch(t.label){case 0:return[4,this.hideLoading()];case 1:return t.sent(),[4,this.hideInfo()];case 2:return t.sent(),[2]}}))}))},hideLoading:function(){return tslib_1.__awaiter(this,void 0,void 0,(function(){return tslib_1.__generator(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,pify_1.pify(wx.hideLoading)()];case 1:return t.sent(),[3,3];case 2:return t.sent(),[3,3];case 3:return[2]}}))}))},hideToast:function(){return tslib_1.__awaiter(this,void 0,void 0,(function(){return tslib_1.__generator(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,pify_1.pify(wx.hideToast)()];case 1:return t.sent(),[3,3];case 2:return t.sent(),[3,3];case 3:return[2]}}))}))},hideInfo:function(){return tslib_1.__awaiter(this,void 0,void 0,(function(){return tslib_1.__generator(this,(function(t){return[2,this.hideToast()]}))}))}};
//# sourceMappingURL=tips.js.map