"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.handleVerifyLoginError=exports.isVerifyLoginError=exports.genVerifyLoginFailError=exports.normalizeError=void 0;var tslib_1=require("tslib"),utillib_1=require("./utillib"),constants_1=require("../constants");exports.normalizeError=function(r){if(r)if(utillib_1.isPlainObject(r))if(r.errMsg)if(["auth deny","scope unauthorized"].some((function(e){return String(r.errMsg).indexOf(e)>-1})))if(0===r.errMsg.indexOf("getUserInfo"))Object.assign(r,{code:constants_1.ErrorCode.GET_USERINFO_NEED_AUTH,msg:"尚未开启微信基本信息授权，请授权后使用"});else{var e=tslib_1.__read(r.errMsg.split(":"),1)[0];Object.assign(r,{code:constants_1.ErrorCode.WX_API_NEED_AUTH,msg:"小程序接口（"+e+"）需要用户授权，请授权后使用"})}else Object.assign(r,{code:constants_1.ErrorCode.WX_API_FAIL,msg:"小程序接口调用失败，请稍后再试"});else exports.isVerifyLoginError(r)&&(r=exports.genVerifyLoginFailError(r));else r instanceof Error&&(r={code:constants_1.ErrorCode.INTERNAL_ERROR,msg:r.message,stack:r.stack,error:r});return r},exports.genVerifyLoginFailError=function(r){r||(r={});r.code,r.msg;var e=tslib_1.__rest(r,["code","msg"]);return tslib_1.__assign({code:constants_1.ErrorCode.VERIFY_LOGIN_FAIL,msg:"登录态验证失败，请重新登录"},e)},exports.isVerifyLoginError=function(r){return r&&["VERIFY_LOGIN_FAIL","InvalidAccessToken"].some((function(e){return String(r.code||"").indexOf(e)>-1}))},exports.handleVerifyLoginError=function(r){if(exports.isVerifyLoginError(r))throw exports.genVerifyLoginFailError(r)};
//# sourceMappingURL=errorHelper.js.map