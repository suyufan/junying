{"version":3,"sources":["../../src/base/LLSyncDeviceAdapterBase.ts"],"names":["qcloud_iotexplorer_appdev_sdk_1","require","utils","tslib_1","__importStar","constants","qcloud_iotexplorer_bluetooth_adapter_1","qcloud_iotexplorer_common_libs_1","LLSyncProtocol_1","libs_1","_a","AppDevSdk","genPromise","delay","envDetect","LLSyncDeviceAdapterBase","_super","props","_this","call","this","on","notifyMessage","bind","writeDataQueue","cancelAllTasks","code","errCode","msg","cause","CancelableQueue","autoStart","handler","businessData","isCancelled","writeDataInternal","params","onTaskSuccess","onSuccess","onTaskError","err","onError","__extends","prototype","_b","type","data","console","log","emit","handleBLEMessage","hex","isEncrypted","authorized","isHeartbeatResp","decryptedHex","decrypt","join","sessionKey","match","error","indicateType","parseInt","result","INDICATE_TYPE_MAP","splice","wait4EventResponse","eventName","timeout","timeoutCode","timeoutHandler","wrapSplitDataMode","_c","shouldWrapSplitDataFn","afterBindEvent","respPromise","promiseResolved","eventHandlerFn","__awaiter","resolve","reject","off","eventHandler","wrapEventHandler","_d","sent","Promise","race","promise","setTimeout","err_1","writeAndWait4Response","data2Write","writeId","writeData","catch","__assign","BLE_WRITE_ERROR","writeMtuResult","body","DEVICE_INFO_WRITE_PREFIX","WRITE_MTU_RESULT","U16ToHexString","write","DEVICE_INFO_WRITE_ID","sliceData","tmpData","mode","fakeMtu","mtu","getMtuEncrypted","length","head","slice","GET_STATUS","push","setMtu","isIOS","setBLEMTU","deviceId","ret","reporter","info","ANDROID_SET_MTU","waitGap","retryTime","Array","isArray","i","retryLeft","WRITE_DATA_CANCEL_ERROR_CODE","e_1","waitGapForRetry","Math","min","MAX_WRITE_DATA_WAIT_GAP","DeviceAdapter","exports"],"mappings":"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"}