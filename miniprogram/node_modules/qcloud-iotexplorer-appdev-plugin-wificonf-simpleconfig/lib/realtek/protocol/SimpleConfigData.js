"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SimpleConfigData=void 0;var qcloud_iotexplorer_appdev_sdk_1=require("qcloud-iotexplorer-appdev-sdk"),qcloud_iotexplorer_appdev_plugin_wificonf_core_1=require("qcloud-iotexplorer-appdev-plugin-wificonf-core"),realtekTaskParameter_1=require("../base/realtekTaskParameter"),_a=qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils,byteUtil=_a.byteUtil,CryptoJS=_a.CryptoJS,formatInetAddr=qcloud_iotexplorer_appdev_plugin_wificonf_core_1.utils.formatInetAddr,arrayFill=qcloud_iotexplorer_appdev_plugin_wificonf_core_1.utils.arrayFill,SimpleConfigAES=qcloud_iotexplorer_appdev_plugin_wificonf_core_1.utils.SimpleConfigAES,SimpleConfigData=function(){function e(){this.SyncRandomNum=4,this.SyncRandomData=new Int8Array(4),console.log(realtekTaskParameter_1.SimpleConfigParam.Default_PIN),this.Flag=realtekTaskParameter_1.SimpleConfigParam.PATTERN_USING_UDP_SOCKET|realtekTaskParameter_1.SimpleConfigParam.PATTERN_VALID,this.Name=byteUtil.getBytesByString(realtekTaskParameter_1.SimpleConfigParam.DEFAULT_PATTERN_NAME)}return e.prototype.scAddTLV=function(e,t,r,a,o){var l=new Int8Array(1),i=new Int8Array(1);return l[0]=byteUtil.convertNumberToByte(0|r),i[0]=t,byteUtil.arrayCopy(i,0,e,o[0]+0,1),byteUtil.arrayCopy(l,0,e,o[0]+1,1),byteUtil.arrayCopy(a,0,e,o[0]+2,r),e},e.prototype.scProfileAddSSID=function(e,t,r,a){return r[0]+2+a.length>t?null:(e=this.scAddTLV(e,byteUtil.convertNumberToByte(1),a.length,a,r),r[0]+=2+a.length,console.log("ssid",e),e)},e.prototype.scProfileAddPasswd=function(e,t,r,a){return r[0]+2+a.length>t?null:(e=this.scAddTLV(e,byteUtil.convertNumberToByte(2),a.length,a,r),r[0]+=2+a.length,console.log("scProfileAddPasswd",e),e)},e.prototype.scProfileAddIP=function(e,t,r,a){var o=formatInetAddr(a);return r[0]+2+o.length>t?null:(e=this.scAddTLV(e,byteUtil.convertNumberToByte(3),o.length,o,r),r[0]+=6,console.log("scProfileAddIP",e),e)},e.prototype.scGenRandom=function(){for(var e=0;e<4;e++){var t=Math.floor(256*Math.random());this.SyncRandomData[e]=byteUtil.convertNumberToByte(255&t)}this.SyncRandomData=[100,-108,-3,-14]},e.prototype.generateKey=function(e){var t=new Int8Array(256),r=(new Int8Array(16),new Int8Array(6)),a=0;arrayFill(r,byteUtil.convertNumberToByte(0)),arrayFill(t,byteUtil.convertNumberToByte(0));for(var o=e.split(":"),l=0;l<o.length&&l<6;l++){var i=byteUtil.getBytesByString(o[l]);r[l]=byteUtil.convertNumberToByte(parseInt(String.fromCodePoint(i[0]))<<4|parseInt(String.fromCodePoint(i[1])))}if(byteUtil.arrayCopy(r,0,t,0,6),a+=6,realtekTaskParameter_1.RtkSC.HavePin)byteUtil.arrayCopy(realtekTaskParameter_1.RtkSC.PIN,0,t,a,8);else{var n=byteUtil.getBytesByString(realtekTaskParameter_1.SimpleConfigParam.Local_PIN);byteUtil.arrayCopy(n,0,t,a,n.length)}a+=realtekTaskParameter_1.SimpleConfigParam.Local_PIN.length;var y=byteUtil.getBytesByString(realtekTaskParameter_1.SimpleConfigParam.McastUDPBuffer);byteUtil.arrayCopy(y,0,t,a,realtekTaskParameter_1.SimpleConfigParam.McastUDPBuffer.length),a+=realtekTaskParameter_1.SimpleConfigParam.McastUDPBuffer.length,byteUtil.arrayCopy(this.SyncRandomData,0,t,a,4),a+=4;var s=CryptoJS.MD5(CryptoJS.lib.WordArray.create(t.slice(0,a)));byteUtil.hexStringToByteArray(s.toString(CryptoJS.enc.Hex)),byteUtil.arrayCopy(this.Name,0,t,a,this.Name.length),a+=this.Name.length,console.log("---buffer",byteUtil.convertBytes2Uint8s(t));var c=CryptoJS.algo.HMAC.create(CryptoJS.algo.SHA1,s);c.update(CryptoJS.lib.WordArray.create(t.slice(0,a)));var p=c.finalize();realtekTaskParameter_1.RtkSC.KeyBuf=byteUtil.hexStringToByteArray(p.toString(CryptoJS.enc.Hex)).slice(0,realtekTaskParameter_1.RtkSC.KeyBuf.length),console.log("---key -buf-",byteUtil.convertBytes2Uint8s(realtekTaskParameter_1.RtkSC.KeyBuf)),realtekTaskParameter_1.RtkSC.KeyLen=16},e.prototype.encryptProfile=function(){var e=new Int8Array(8);if(arrayFill(e,byteUtil.convertNumberToByte(-90)),0!=(this.Flag&realtekTaskParameter_1.SimpleConfigParam.PATTERN_USING_PLAIN))return byteUtil.arrayCopy(realtekTaskParameter_1.RtkSC.PlainBuf,0,realtekTaskParameter_1.RtkSC.KeyBuf,0,realtekTaskParameter_1.RtkSC.PlainCurrentLen[0]),void(realtekTaskParameter_1.RtkSC.CryptLen[0]=realtekTaskParameter_1.RtkSC.PlainCurrentLen[0]);var t=realtekTaskParameter_1.RtkSC.PlainCurrentLen[0];t+=16-t%16;var r=byteUtil.convertBytes2Uint8s(realtekTaskParameter_1.RtkSC.PlainBuf.slice(0,t)),a=byteUtil.convertBytes2Uint8s(realtekTaskParameter_1.RtkSC.KeyBuf),o=byteUtil.convertBytes2Uint8s(e);console.log("---",r,a,o),realtekTaskParameter_1.RtkSC.CryptLen[0]=SimpleConfigAES(r,t,o,o.length,a,a.length,realtekTaskParameter_1.RtkSC.CryptBuf),console.log("---",byteUtil.convertBytes2Uint8s(realtekTaskParameter_1.RtkSC.CryptBuf),realtekTaskParameter_1.RtkSC.CryptLen[0])},e.prototype.mcastUDPCreateSync=function(e,t){var r=new Int8Array(32),a="\0".charCodeAt(),o=[0,0,0,0,0,0],l=[0,0,0];l[0]=1,l[1]=0,l[2]=94;for(var i=r,n="\0".charCodeAt();n<"\t".charCodeAt();n="".charCodeAt()+n)arrayFill(o,byteUtil.convertNumberToByte(0)),byteUtil.arrayCopy(l,0,o,0,3),o[3]=byteUtil.convertUint8toByte(a),n<="".charCodeAt()?o[5]=byteUtil.convertUint8toByte(e>>8*("".charCodeAt()-n)&255):n==="".charCodeAt()?o[5]=byteUtil.convertNumberToByte(9+t):n==="".charCodeAt()?o[5]=byteUtil.convertNumberToByte(i[0]+i[4]+i[8]+i[11]):o[5]=this.SyncRandomData[n-"".charCodeAt()],o[4]=byteUtil.convertNumberToByte(realtekTaskParameter_1.SimpleConfigParam.CHECKSUM(o,6)),byteUtil.arrayCopy(o,3,r,n*"".charCodeAt(),3),a="".charCodeAt()+a;return r},e}();exports.SimpleConfigData=SimpleConfigData;
//# sourceMappingURL=SimpleConfigData.js.map