{"version":3,"sources":["../../src/base/DeviceAdapter.ts"],"names":["qcloud_iotexplorer_appdev_sdk_1","require","BlueToothBase_1","types_1","_a","AppDevSdk","utils","arrayBufferToHexStringArray","hexToArrayBuffer","DeviceAdapter","_super","deviceId","productId","deviceName","name","actions","bluetoothApi","h5Websocket","_b","extendInfo","bluetoothAdapter","_this","call","this","_name","_deviceId","_deviceName","_deviceConnected","_productId","_deviceRegistered","_characteristicsAutoNotified","_services","characteristicsMap","_actions","_bluetoothApi","_h5Websocket","communicationMode","CommunicationMode","GATT","on","tslib_1","__extends","prototype","_getNotifyId","serviceId","writeIds","notifyIds","readIds","indicateIds","Object","defineProperty","join","constructor","explorerDeviceId","originName","init","sent","console","warn","handleBLEMessage","hexStrArr","characteristicId","registerDevice","bindDevice","_c","familyId","_d","roomId","_e","params","emit","Promise","reject","_normalizeError","err_1","onBleConnectionStateChange","connected","log","statusChanged","__assign","deviceInfo","onBLECharacteristicValueChange","value","hexValue","ArrayBuffer","shouldIgnore","reportData","message","__rest","timestamp","Date","now","dataReported","reportDeviceData","data","error","err_2","disconnectDevice","closeBLEConnection","connectDevice","autoNotify","startTime","isConnected","stepStart","createBLEConnection","autoNotifyCharacteristics","err_3","err_4","errMsg","indexOf","resolve","force","getBLEDeviceServices","services","getBLEDeviceCharacteristics","characteristics","notifyBLECharacteristicValueChange","write","writeId","err","_write","writeBLECharacteristicValue","_writeId","err_5","setCharacteristicsIds","map","setCharacteristicsId","idSet","uuid","push","forEach","properties","notify","indicate","read","state","_f","readBLECharacteristicValue","setBLEMTU","getBLEDeviceRSSI","destroy","advertFilter","advert","onScanAdvert","deviceFilter","BlueToothBase","exports"],"mappings":"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"}