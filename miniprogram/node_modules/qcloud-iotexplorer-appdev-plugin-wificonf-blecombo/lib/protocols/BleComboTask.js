"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BleComboTask=void 0;var tslib_1=require("tslib"),qcloud_iotexplorer_appdev_sdk_1=require("qcloud-iotexplorer-appdev-sdk"),delay=qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.delay,BleComboTask=function(e){function t(t){var r=t.targetWifiInfo,s=t.wifiConfToken,i=void 0===s?"":s,o=t.deviceAdapter,n=t.reporter,a=e.call(this)||this;a.sequence=0,a.sendDataInterval=300;var d=r.SSID,c=r.password;return a.ssid=d,a.password=c||"",a.token=i,a.deviceAdapter=o,a.logger=n,a.processing=!1,a.logger.info("ssid/password",{data:d+"/"+c.replace(/^\w{3}/,"***")}),a}return tslib_1.__extends(t,e),t.prototype.start=function(){return tslib_1.__awaiter(this,void 0,void 0,(function(){var e;return tslib_1.__generator(this,(function(t){switch(t.label){case 0:if(this.processing)return[2,Promise.reject({code:"PROCESSING_PLEASE_WAIT"})];this.processing=!0,t.label=1;case 1:return t.trys.push([1,8,,9]),console.info("[plugin]: start to set wifi mode"),[4,this.setWiFiMode()];case 2:return t.sent(),[4,delay(this.sendDataInterval)];case 3:return t.sent(),console.info("[plugin]: start to send wifi info"),[4,this.sendWiFiInfo()];case 4:return t.sent(),[4,delay(this.sendDataInterval)];case 5:return t.sent(),console.info("[plugin]: start to connect wifi"),[4,this.connectWifi()];case 6:return t.sent(),[4,delay(this.sendDataInterval)];case 7:return t.sent(),[3,9];case 8:return e=t.sent(),console.error(e),[2,Promise.reject({error:e})];case 9:return[2]}}))}))},t.prototype.interrupt=function(){this.processing=!1,this.deviceAdapter.disconnectDevice()},t}(qcloud_iotexplorer_appdev_sdk_1.AppDevSdk.utils.EventEmitter);exports.BleComboTask=BleComboTask;
//# sourceMappingURL=BleComboTask.js.map